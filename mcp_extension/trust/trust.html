<!--
  ~ Â© 2025 Snyk Limited
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Snyk Trust Confirmation</title>
  <style>
    * { box-sizing: border-box; }
    html, body { width: 100%; height: 100vh; }
    :root { background-color: #f9f8fa; color: #1c1c21; font-size: 10px; line-height: 1.6; font-family: Roboto, system-ui, ui-sans-serif, -apple-system, Helvetica, Arial, sans-serif}

    .snx-trust { display: flex; flex-direction: column; align-items: center; justify-content: center; gap:1.2rem; width: 100%; height:100%; }
    .snx-content { display: flex; flex-direction: column; gap:1.2rem; max-width: 372px; text-align: center;}

    .snx-heading.h1 { margin:1.6rem 0 0; font-size: 2.4rem; line-height: 1; font-weight: 400; }
    .snx-text { font-size: 1.4rem; margin: .8rem 0; }
    .snx-buttons { display: flex; gap: 10px; justify-content: center; }
    .snx-button { padding: 0 1.2rem; border: 1px solid #b3b2bd; border-radius: .4rem; line-height: 28px; color:#555463; font-size:1.4rem; cursor: pointer; background-color:#fff; font-weight: 500; font-family: Roboto, system-ui, ui-sans-serif, -apple-system, Helvetica, Arial, sans-serif; }
    .snx-button.is-primary { background-color: #145deb; color: #fff; border-color: #145deb; }

    .snx-header { display: flex; gap: 1rem; align-items: center; justify-content: center; }
    .snx-square { display:inline-flex; width: 4rem; height: 4rem; border-radius: .8rem; justify-content: center; align-content: center; align-items:center; font-size:3.2rem; line-height: 1; box-shadow:0 2px 4px 0 #0000001a; border:1px solid #d3d3d9; }
    .snx-square.is-transparent { border-color: transparent; background-color: transparent; box-shadow: none; color: #727184 }
    .snx-mcp { font-size: 1.6rem; font-weight: 700; letter-spacing: -1px; }

    .snx-warning { padding: 1.6rem 2.4rem; background-color: #fff; border: 1px solid #d3d3d9; border-radius: .8rem; }
    .snx-path { padding: .8rem 1.2rem; margin:0 0 1.6rem; background-color: rgba(0,0,0,.05); border: 1px solid #d3d3d9; border-radius: .4rem; }
  </style>
</head>
<body>
<div class="snx-trust" id="container">

  <div class="snx-content">
    <div class="snx-header">
      <div class="snx-square snx-logo">
        <svg width="20" height="32" viewBox="0 0 20 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_15493_10455)">
            <path d="M19.3881 7.08278C19.128 7.00992 18.8559 6.93707 18.5716 6.86768C18.6613 7.20758 18.7111 7.55693 18.7198 7.90853V8.15833L17.5312 11.3815C18.1341 16.9622 17.8395 17.7238 17.743 17.9736C17.5897 18.3708 17.1798 19.0144 16.4924 19.9512L17.1677 26.2345L19.6241 24.4616C19.7244 24.3893 19.806 24.294 19.8623 24.1836C19.9187 24.0731 19.948 23.9508 19.948 23.8266V7.8322C19.9473 7.66321 19.8925 7.49896 19.7916 7.36391C19.6907 7.22887 19.5492 7.13026 19.3881 7.08278V7.08278Z" fill="#21214C"/>
            <path d="M19.948 23.8286C19.948 23.9527 19.9187 24.0751 19.8623 24.1855C19.806 24.2959 19.7244 24.3912 19.6241 24.4635L17.1677 26.2364L16.4924 19.9532C17.1815 19.0199 17.5897 18.3728 17.743 17.9755C17.8395 17.7257 18.1341 16.9642 17.5312 11.3835L18.7198 8.16029V7.91048C18.7111 7.55888 18.6613 7.20953 18.5716 6.86963C18.8559 6.93902 19.128 7.01188 19.3881 7.08474C19.5495 7.1323 19.6912 7.23117 19.7921 7.36656C19.893 7.50195 19.9477 7.6666 19.948 7.83588V23.8286Z" fill="#21214C"/>
            <path d="M7.9583 7.41262C9.2744 7.02519 10.6731 7.02519 11.9892 7.41262L12.1425 7.15934L12.3148 5.98492C11.7274 5.95716 10.7145 5.91553 9.9927 5.91553C9.20547 5.91553 8.41824 5.93808 7.64307 5.97971L7.81533 7.15934L7.9583 7.41262Z" fill="#21214C"/>
            <path d="M9.98766 5.91748C10.7094 5.91748 11.7223 5.95912 12.3097 5.98687L12.1375 7.1613L11.9842 7.41458C10.6681 7.02714 9.26935 7.02714 7.95326 7.41458L7.79995 7.16304L7.62769 5.9834C8.4132 5.94003 9.20043 5.91748 9.98766 5.91748Z" fill="#21214C"/>
            <path d="M2.4168 11.3835L1.23164 8.16202V7.91048C1.24027 7.55899 1.28941 7.2097 1.37806 6.86963C1.09555 6.93902 0.821657 7.01188 0.563266 7.08474C0.401791 7.13205 0.259922 7.23085 0.15897 7.3663C0.0580173 7.50175 0.0034335 7.66653 0.003418 7.83588V23.8286C0.00338058 23.9527 0.0327421 24.0751 0.0890648 24.1855C0.145388 24.2959 0.227048 24.3912 0.327269 24.4635L2.79405 26.2486L3.47103 19.9722C2.78199 19.0285 2.36339 18.3763 2.20836 17.9755C2.10845 17.724 1.81388 16.9624 2.4168 11.3835Z" fill="#21214C"/>
            <path d="M2.79407 26.2486L0.323849 24.4652C0.223627 24.393 0.141967 24.2977 0.0856442 24.1872C0.0293215 24.0768 -3.73895e-05 23.9545 3.57358e-08 23.8303V7.83588C1.55362e-05 7.66653 0.0545993 7.50175 0.155552 7.3663C0.256504 7.23085 0.398373 7.13205 0.559848 7.08474C0.81824 7.01188 1.09213 6.93902 1.37464 6.86963C1.28599 7.2097 1.23685 7.55899 1.22822 7.91048V8.16202L2.41682 11.3835C1.81391 16.9624 2.10847 17.724 2.20494 17.9755C2.35997 18.3763 2.7734 19.0285 3.46761 19.9722L2.79407 26.2486Z" fill="#21214C"/>
            <path d="M16.7918 17.604C16.9848 17.1061 16.8745 14.7521 16.4955 11.3051V11.2531L17.7014 7.97612V7.9102C17.7014 6.48076 15.8633 2.65563 14.7729 0.62423L14.4904 0.103804C14.4732 0.0716839 14.4464 0.0458335 14.4138 0.0299304C14.3812 0.0140274 14.3445 0.00887836 14.3088 0.0152183C14.2731 0.0215582 14.2404 0.0390666 14.2151 0.0652471C14.1899 0.0914275 14.1735 0.124948 14.1683 0.161048L13.1175 7.51294L12.444 8.62839L12.2717 8.57114C11.5275 8.31275 10.7486 8.17002 9.96167 8.14786C9.17724 8.16654 8.40062 8.30938 7.66027 8.57114L7.48801 8.62839L6.8248 7.51294L5.77746 0.147173C5.77272 0.110524 5.75648 0.076356 5.73111 0.0496508C5.70574 0.0229455 5.67257 0.00509572 5.63642 -0.00129388C5.60027 -0.00768347 5.56304 -0.00228009 5.53016 0.0141277C5.49728 0.0305355 5.47045 0.0570903 5.4536 0.0899227L5.17282 0.610349C4.08585 2.64522 2.24438 6.47035 2.24438 7.89632V7.96224L3.45021 11.2392V11.2912C3.07124 14.7382 2.96099 17.0923 3.15392 17.5901C3.32618 18.036 4.01523 18.9918 4.58713 19.7534L3.75856 27.4644L4.58369 28.0594L5.20211 28.5052L9.27091 31.4526C9.47563 31.6002 9.72109 31.6795 9.97287 31.6795C10.2247 31.6795 10.4701 31.6002 10.6748 31.4526L15.7014 27.8304L16.2027 27.4678L15.3741 19.7499C15.9443 18.9918 16.6213 18.0481 16.7918 17.604ZM14.7643 4.76683L14.8952 3.8474C14.8999 3.8182 14.9137 3.79125 14.9345 3.77038C14.9553 3.74951 14.9822 3.73579 15.0112 3.73117C15.0402 3.72656 15.0699 3.73129 15.0961 3.74468C15.1223 3.75808 15.1436 3.77945 15.1571 3.80577C15.8237 5.20572 16.4662 6.73924 16.5352 7.44008C16.5366 7.46071 16.5337 7.48142 16.5265 7.5008L16.2044 8.36817C16.1956 8.3926 16.1801 8.41404 16.1597 8.43004C16.1394 8.44603 16.115 8.45595 16.0893 8.45867C16.0636 8.46138 16.0377 8.45677 16.0145 8.44537C15.9913 8.43397 15.9718 8.41624 15.9581 8.3942C15.1571 7.12435 14.8435 5.31674 14.7678 4.80152C14.7652 4.78956 14.764 4.77733 14.7643 4.76509V4.76683ZM11.5671 13.8032C11.9358 13.4354 12.6007 12.9236 13.4362 12.9236C14.549 12.9236 13.9082 13.7806 13.6911 14.0374C13.6749 14.0564 13.6549 14.0717 13.6323 14.0822C13.6097 14.0926 13.5851 14.0981 13.5602 14.0981H11.6877C11.654 14.0976 11.6212 14.0872 11.5933 14.0681C11.5654 14.049 11.5437 14.0221 11.5309 13.9907C11.518 13.9593 11.5146 13.9248 11.5211 13.8914C11.5275 13.8581 11.5435 13.8274 11.5671 13.8032ZM12.5249 15.3957C12.5532 15.4673 12.6001 15.5299 12.6607 15.5769C12.7214 15.6239 12.7935 15.6536 12.8694 15.6628C12.9771 15.6781 13.0866 15.6519 13.176 15.5896C13.2654 15.5272 13.3281 15.4332 13.3518 15.3263C13.2892 15.3253 13.2289 15.3019 13.1819 15.2602C13.1349 15.2186 13.1041 15.1614 13.0951 15.099C13.0894 15.0583 13.0933 15.0169 13.1065 14.978C13.1197 14.9392 13.1417 14.9039 13.1709 14.8752L13.1588 14.8648H13.9116V14.903C13.9159 15.0355 13.8935 15.1675 13.8458 15.2911C13.7981 15.4146 13.7261 15.5272 13.6341 15.622C13.5421 15.7169 13.432 15.792 13.3105 15.8429C13.1889 15.8938 13.0584 15.9194 12.9268 15.9183C12.7952 15.9171 12.6651 15.8891 12.5445 15.8361C12.4238 15.783 12.3151 15.7059 12.2248 15.6095C12.1345 15.513 12.0645 15.3992 12.0189 15.2748C11.9734 15.1504 11.9533 15.0181 11.9599 14.8857V14.8648H12.7023C12.6149 14.9176 12.5488 14.9999 12.5157 15.097C12.4826 15.1941 12.4846 15.2999 12.5215 15.3957H12.5249ZM6.51818 12.9236C7.35709 12.9236 8.01857 13.4354 8.38721 13.8032C8.41102 13.8276 8.4271 13.8586 8.43344 13.8923C8.43978 13.9259 8.43608 13.9607 8.42282 13.9923C8.40955 14.0238 8.38732 14.0507 8.35891 14.0695C8.3305 14.0883 8.29719 14.0983 8.26318 14.0981H6.39932C6.37444 14.0981 6.34985 14.0926 6.32725 14.0822C6.30465 14.0717 6.28457 14.0564 6.2684 14.0374C6.04274 13.7806 5.40193 12.9236 6.51473 12.9236H6.51818ZM6.8627 15.099C6.85223 15.1602 6.82083 15.2157 6.77394 15.2559C6.72705 15.2962 6.66764 15.3186 6.60603 15.3193C6.62703 15.4284 6.68876 15.5251 6.77849 15.5897C6.86823 15.6542 6.97914 15.6816 7.08836 15.6663C7.15861 15.6569 7.22533 15.6296 7.28227 15.5872C7.33922 15.5447 7.38452 15.4883 7.41394 15.4234C7.45827 15.3271 7.46628 15.2178 7.43649 15.116C7.40669 15.0142 7.34112 14.9267 7.25201 14.87H7.97379C7.97914 14.8704 7.98416 14.8728 7.98796 14.8766C7.99175 14.8804 7.99406 14.8855 7.99446 14.8909C8.00102 15.0233 7.98094 15.1556 7.93542 15.28C7.8899 15.4044 7.81988 15.5183 7.72957 15.6147C7.63926 15.7112 7.53052 15.7882 7.40988 15.8413C7.28925 15.8944 7.15921 15.9223 7.02757 15.9235C6.89594 15.9246 6.76542 15.899 6.64388 15.8481C6.52233 15.7972 6.41226 15.7221 6.32027 15.6272C6.22828 15.5324 6.15628 15.4198 6.10859 15.2963C6.06089 15.1727 6.03849 15.0407 6.04274 14.9082V14.87H6.79552L6.78346 14.8804C6.8125 14.9083 6.83476 14.9425 6.8485 14.9804C6.86225 15.0183 6.86711 15.0589 6.8627 15.099V15.099ZM4.01695 8.39767C4.00301 8.41962 3.98328 8.43723 3.95997 8.44854C3.93666 8.45985 3.91069 8.46441 3.88495 8.46171C3.85922 8.45901 3.83473 8.44916 3.81424 8.43325C3.79374 8.41735 3.77804 8.39602 3.76889 8.37165L3.44849 7.50427C3.4405 7.48511 3.43754 7.4642 3.43988 7.44355C3.50534 6.74965 4.14787 5.20919 4.81796 3.80924C4.83095 3.78261 4.85208 3.76089 4.87823 3.74723C4.90438 3.73358 4.93419 3.72873 4.96328 3.73338C4.99237 3.73804 5.01921 3.75196 5.03987 3.77311C5.06053 3.79425 5.07392 3.82151 5.07808 3.85088L5.20899 4.77029C5.21071 4.78354 5.21071 4.79695 5.20899 4.8102C5.12975 5.32021 4.81624 7.12783 4.01695 8.39767ZM6.451 23.9411C5.90321 22.4301 5.89632 20.3154 5.89632 20.2252V20.0812L5.80674 19.9685C5.57074 19.6753 5.28996 19.3127 5.00228 18.9276C4.98518 18.9053 4.97374 18.8791 4.96897 18.8513C4.96419 18.8235 4.96622 18.7949 4.97487 18.7681C4.98353 18.7413 4.99855 18.717 5.01863 18.6973C5.03872 18.6777 5.06326 18.6632 5.09013 18.6553L6.56641 18.2216C6.59775 18.2123 6.62583 18.1943 6.64737 18.1695L8.05647 16.551C8.0791 16.5251 8.10889 16.5065 8.14205 16.4977C8.1752 16.489 8.21021 16.4903 8.24258 16.5017C8.27495 16.5131 8.30322 16.5339 8.32377 16.5615C8.34432 16.5892 8.35621 16.6224 8.35792 16.6568L8.60426 21.2956C8.60563 21.3333 8.59475 21.3705 8.57325 21.4014C8.47506 21.5471 8.19428 21.9877 8.19428 22.2584C8.19428 22.6053 8.70245 23.0598 9.20373 23.4224C9.20932 23.4076 9.21564 23.3931 9.22268 23.379C9.39494 23.0633 9.62749 23.006 9.73946 23.2489C9.77771 23.4283 9.79104 23.6122 9.77908 23.7954H9.78769V24.2221C9.7878 24.2485 9.78191 24.2746 9.77047 24.2984C9.67917 24.4841 9.23646 25.2786 8.29419 25.2786C7.88248 25.2907 6.89371 25.1589 6.451 23.9411V23.9411ZM10.6507 25.7018C10.665 25.7016 10.6791 25.7058 10.6909 25.714C10.7027 25.7221 10.7117 25.7338 10.7167 25.7474C10.7216 25.7609 10.7222 25.7757 10.7184 25.7896C10.7146 25.8035 10.7066 25.8159 10.6955 25.825C10.4884 25.9848 10.2347 26.0714 9.97373 26.0714C9.71279 26.0714 9.45911 25.9848 9.25196 25.825C9.24097 25.816 9.23301 25.8038 9.22917 25.79C9.22533 25.7763 9.2258 25.7617 9.23051 25.7482C9.23522 25.7347 9.24395 25.723 9.25549 25.7147C9.26704 25.7064 9.28084 25.7019 9.29502 25.7018H10.6507ZM11.9099 26.2101C11.7217 26.5625 11.4422 26.8568 11.1011 27.062C10.76 27.2672 10.3702 27.3756 9.97287 27.3756C9.57558 27.3756 9.1857 27.2672 8.84464 27.062C8.50358 26.8568 8.22407 26.5625 8.0358 26.2101C8.02092 26.1829 8.01358 26.1521 8.01455 26.1211C8.01552 26.09 8.02476 26.0597 8.04131 26.0335C8.05786 26.0073 8.08111 25.986 8.10863 25.9719C8.13614 25.9578 8.16692 25.9514 8.19772 25.9534H8.30108C8.41008 25.9542 8.51879 25.942 8.62493 25.917C8.65834 25.9088 8.69342 25.9108 8.72566 25.9229C8.75789 25.935 8.7858 25.9564 8.8058 25.9846C8.93797 26.1733 9.1132 26.3272 9.31675 26.4334C9.52029 26.5397 9.7462 26.5951 9.97546 26.5951C10.2047 26.5951 10.4306 26.5397 10.6342 26.4334C10.8377 26.3272 11.0129 26.1733 11.1451 25.9846C11.1651 25.9564 11.193 25.935 11.2253 25.9229C11.2575 25.9108 11.2926 25.9088 11.326 25.917C11.4388 25.9443 11.5545 25.9577 11.6705 25.9569H11.7515C11.7816 25.9556 11.8116 25.9623 11.8384 25.9764C11.8652 25.9904 11.8879 26.0113 11.9041 26.037C11.9203 26.0626 11.9296 26.0921 11.9309 26.1225C11.9322 26.1529 11.9256 26.1831 11.9117 26.2101H11.9099ZM14.9676 18.9346C14.6816 19.3128 14.3991 19.6753 14.1631 19.9754L14.0735 20.0882V20.2322C14.0735 20.3224 14.0735 22.437 13.5189 23.948C13.0779 25.1623 12.0874 25.2977 11.6826 25.2977C10.7403 25.2977 10.3045 24.5031 10.208 24.3175C10.196 24.2939 10.1895 24.2678 10.1891 24.2412V23.8144H10.1977C10.1857 23.6313 10.199 23.4474 10.2373 23.268C10.3424 23.0251 10.5715 23.0824 10.7541 23.3981C10.7541 23.412 10.7661 23.4276 10.773 23.4415C11.2743 23.0789 11.7825 22.6244 11.7825 22.2774C11.7825 22.0068 11.5 21.5662 11.4018 21.4205C11.3809 21.3893 11.3706 21.3522 11.3725 21.3147L11.6171 16.6759C11.6188 16.6414 11.6307 16.6083 11.6513 16.5806C11.6718 16.553 11.7001 16.5321 11.7324 16.5208C11.7648 16.5094 11.7998 16.508 11.833 16.5168C11.8661 16.5256 11.8959 16.5442 11.9186 16.5701L13.3277 18.1886C13.3497 18.2136 13.3784 18.2317 13.4103 18.2407L14.8849 18.6744C14.9094 18.6835 14.9315 18.6981 14.9496 18.7172C14.9677 18.7362 14.9812 18.7591 14.9892 18.7842C14.9971 18.8093 14.9993 18.8358 14.9956 18.8619C14.9919 18.8879 14.9823 18.9128 14.9676 18.9346V18.9346Z" fill="#21214C"/>
          </g>
          <defs>
            <clipPath id="clip0_15493_10455">
              <rect width="19.9478" height="31.6818" fill="white"/>
            </clipPath>
          </defs>
        </svg>
      </div>
      <div class="snx-square is-transparent">+</div>
      <div class="snx-square snx-mcp"><span>MCP</span></div>
    </div>

    <h1 class="snx-heading h1">Do you trust this path?</h1>
    <p class="snx-text snx-warning">
      The Snyk MCP Server is requesting to add the following path to your list of trusted folders. This allows Snyk to perform scans and analysis on this folder and its contents.
    </p>
    <p class="snx-text snx-path">
      <code>{{.Path}}</code>
    </p>
    <div class="snx-buttons">
      <button id="cancelBtn" class="snx-button" onclick="sendAction('/cancel')">Cancel</button>
      <button id="trustBtn" class="snx-button is-primary" onclick="sendAction('/trust')">Trust path</button>
    </div>
  </div>
</div>

<div id="message" class="snx-message"></div>
<script>
  function sendAction(action) {
    var messageElem = document.getElementById('message');
    var containerElem = document.getElementById('container');

    messageElem.style.color = "#333";
    messageElem.innerText = "Processing your request...";

    var xhr = new XMLHttpRequest();
    xhr.open('POST', action, true);

    xhr.onload = function() {
      containerElem.style.display = 'none';
      if (xhr.status >= 200 && xhr.status < 300) {
        messageElem.style.color = "green";
        messageElem.innerText = xhr.responseText + " You can now close this page.";
      } else {
        messageElem.style.color = "red";
        messageElem.innerText = "Error: " + (xhr.responseText || "Request failed with status " + xhr.status) + ". Please close this page.";
      }
    };

    xhr.onerror = function() {
      containerElem.style.display = 'none';
      messageElem.style.color = "red";
      messageElem.innerText = "Request failed. Please close this page.";
    };

    xhr.send();
  }
</script>
</body>
</html>
