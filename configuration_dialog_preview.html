<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snyk Configuration - Preview (Updated with All Settings)</title>
    <style>
        body {
    font-family: var(--vscode-font-family, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif);
    font-size: var(--vscode-font-size, 13px);
    color: var(--vscode-foreground, #cccccc);
    background-color: var(--vscode-editor-background, #1e1e1e);
    padding: 20px;
    margin: 0;
}

h1 {
    font-size: 24px;
    margin-bottom: 20px;
    color: var(--vscode-editor-foreground, #ffffff);
}

h2 {
    font-size: 18px;
    margin-top: 20px;
    margin-bottom: 15px;
    color: var(--vscode-editor-foreground, #ffffff);
    border-bottom: 1px solid var(--vscode-panel-border, #454545);
    padding-bottom: 8px;
}

h3 {
    font-size: 14px;
    margin-top: 15px;
    margin-bottom: 10px;
    color: var(--vscode-editor-foreground, #cccccc);
}

.section {
    margin-bottom: 30px;
    padding: 15px;
    background-color: var(--vscode-editor-inactiveSelectionBackground, #2a2d2e);
    border-radius: 4px;
}

.folder-config {
    margin-bottom: 20px;
    padding: 15px;
    background-color: var(--vscode-editor-background, #252526);
    border: 1px solid var(--vscode-panel-border, #454545);
    border-radius: 4px;
}

.form-group {
    margin-bottom: 15px;
}

.checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 8px;
}

label {
    display: block;
    margin-bottom: 5px;
    font-weight: 600;
    color: var(--vscode-input-foreground, #cccccc);
}

.checkbox-label {
    display: flex;
    align-items: center;
    font-weight: normal;
    cursor: pointer;
}

.checkbox-label input[type="checkbox"] {
    margin-right: 8px;
}

input[type="text"],
input[type="password"],
input[type="number"],
select,
textarea {
    width: 100%;
    padding: 8px;
    background-color: var(--vscode-input-background, #3c3c3c);
    color: var(--vscode-input-foreground, #cccccc);
    border: 1px solid var(--vscode-input-border, #454545);
    border-radius: 2px;
    box-sizing: border-box;
    font-family: inherit;
    font-size: inherit;
}

input[readonly] {
    background-color: var(--vscode-input-background, #2d2d2d);
    color: var(--vscode-disabledForeground, #808080);
    cursor: not-allowed;
}

textarea {
    resize: vertical;
    font-family: var(--vscode-editor-font-family, 'Monaco', 'Courier New', monospace);
    font-size: 12px;
}

input:focus,
select:focus,
textarea:focus {
    outline: 1px solid var(--vscode-focusBorder, #007acc);
    outline-offset: -1px;
}

.description {
    display: block;
    font-size: 11px;
    color: var(--vscode-descriptionForeground, #969696);
    margin-top: 4px;
    font-style: italic;
}

.error-message {
    color: var(--vscode-errorForeground, #f48771);
    font-size: 12px;
    margin-top: 5px;
    display: block;
}

.hidden {
    display: none !important;
}

.actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid var(--vscode-panel-border, #454545);
}

button {
    padding: 10px 20px;
    background-color: var(--vscode-button-background, #0e639c);
    color: var(--vscode-button-foreground, #ffffff);
    border: none;
    border-radius: 2px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 600;
}

button:hover {
    background-color: var(--vscode-button-hoverBackground, #1177bb);
}

button:active {
    background-color: var(--vscode-button-background, #0e639c);
}

button.secondary {
    background-color: var(--vscode-button-secondaryBackground, #3a3d41);
    color: var(--vscode-button-secondaryForeground, #ffffff);
}

button.secondary:hover {
    background-color: var(--vscode-button-secondaryHoverBackground, #45494e);
}

.info-banner {
    background-color: var(--vscode-textBlockQuote-background, #3a3d41);
    border-left: 4px solid var(--vscode-focusBorder, #007acc);
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 4px;
}

.info-banner h2 {
    margin-top: 0;
    font-size: 16px;
    border-bottom: none;
}

.info-banner ul {
    margin: 10px 0;
    padding-left: 20px;
}
    </style>
</head>
<body>
    <div class="info-banner">
        <h2>✅ Configuration Dialog Preview - User-Configurable Settings Only</h2>
        <p>This preview demonstrates the configuration dialog with <strong>all user-configurable settings</strong> (auto-populated system fields are excluded):</p>
        <ul>
            <li>✅ Core authentication settings (Token, Endpoint, Organization, Authentication Method)</li>
            <li>✅ Product activation toggles (OSS, Code, IaC, Security, Quality)</li>
            <li>✅ CLI and path configuration</li>
            <li>✅ Security settings (Insecure mode, Trusted folders)</li>
            <li>✅ Filter severity and display options</li>
            <li>✅ Feature toggles (Learn, Quick Fix, Browser Actions, Delta Findings)</li>
            <li>✅ Advanced settings (Snyk Code API, CLI parameters, Environment variables)</li>
            <li>✅ All 12 folder-specific configuration fields</li>
        </ul>
        <p><strong>System fields excluded:</strong> Integration Name/Version, Device ID, OS Platform/Arch, Runtime Name/Version, and Protocol Version are auto-populated by the IDE and not shown in the dialog.</p>
    </div>

    <h1>Snyk Configuration</h1>
    <form id="configForm">
        
        <!-- Core Authentication Settings -->
        <div class="section">
            <h2>Authentication</h2>

            <div class="form-group">
                <label for="token">Token</label>
                <input type="password" id="token" name="token" value="snyk-test-token-12345" placeholder="Snyk API Token">
            </div>

            <div class="form-group">
                <label for="endpoint">Endpoint</label>
                <input type="text" id="endpoint" name="endpoint" value="https://api.snyk.io" placeholder="https://app.snyk.io/api">
                <span id="endpoint-error" class="error-message hidden">Invalid Endpoint URL. Expected format: https://api.snyk.io or https://api.*.snykgov.io</span>
            </div>

            <div class="form-group">
                <label for="organization">Organization</label>
                <input type="text" id="organization" name="organization" value="my-organization" placeholder="Organization Slug">
            </div>

            <div class="form-group">
                <label for="authenticationMethod">Authentication Method</label>
                <select id="authenticationMethod" name="authenticationMethod">
                    <option value="token" selected>Token</option>
                    <option value="oauth">OAuth</option>
                </select>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="automaticAuthentication" checked>
                    Automatic Authentication
                </label>
            </div>
        </div>

        <!-- Product Activation -->
        <div class="section">
            <h2>Product Activation</h2>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="activateSnykOpenSource" checked>
                    Activate Snyk Open Source
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="activateSnykCode" checked>
                    Activate Snyk Code
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="activateSnykIac" checked>
                    Activate Snyk IaC
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="activateSnykCodeSecurity" checked>
                    Activate Snyk Code Security
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="activateSnykCodeQuality">
                    Activate Snyk Code Quality
                </label>
            </div>
        </div>

        <!-- CLI and Paths -->
        <div class="section">
            <h2>CLI and Paths</h2>

            <div class="form-group">
                <label for="cliPath">CLI Path</label>
                <input type="text" id="cliPath" name="cliPath" value="/usr/local/bin/snyk" placeholder="Path to Snyk CLI">
            </div>

            <div class="form-group">
                <label for="path">Path (Environment PATH)</label>
                <input type="text" id="path" name="path" value="/usr/local/bin:/usr/bin" placeholder="Additional PATH directories">
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="manageBinariesAutomatically" checked>
                    Manage Binaries Automatically
                </label>
            </div>
        </div>

        <!-- Security Settings -->
        <div class="section">
            <h2>Security Settings</h2>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="insecure">
                    Insecure (Skip SSL Verification)
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="enableTrustedFoldersFeature" checked>
                    Enable Trusted Folders Feature
                </label>
            </div>

            <div class="form-group">
                <label for="trustedFolders">Trusted Folders</label>
                <input type="text" id="trustedFolders" name="trustedFolders" value="/home/user/projects,/workspace" placeholder="Comma-separated paths">
                <span class="description">Comma-separated list of trusted folder paths</span>
            </div>
        </div>

        <!-- Operational Settings -->
        <div class="section">
            <h2>Operational Settings</h2>

            <div class="form-group">
                <label for="scanningMode">Scanning Mode</label>
                <select id="scanningMode" name="scanningMode">
                    <option value="auto" selected>Auto</option>
                    <option value="manual">Manual</option>
                </select>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="sendErrorReports" checked>
                    Send Error Reports
                </label>
            </div>
        </div>

        <!-- Filter and Display Settings -->
        <div class="section">
            <h2>Filter and Display Settings</h2>

            <div class="form-group">
                <label>Filter Severity</label>
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="filterSeverity_critical" checked>
                        Critical
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="filterSeverity_high" checked>
                        High
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="filterSeverity_medium" checked>
                        Medium
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="filterSeverity_low">
                        Low
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label for="hoverVerbosity">Hover Verbosity (0-3)</label>
                <input type="number" id="hoverVerbosity" name="hoverVerbosity" min="0" max="3" value="3">
            </div>

            <div class="form-group">
                <label for="outputFormat">Output Format</label>
                <input type="text" id="outputFormat" name="outputFormat" value="md" placeholder="json, text, md">
            </div>

            <div class="form-group">
                <label>Issue View Options</label>
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="issueViewOptions_openIssues" checked>
                        Show Open Issues
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="issueViewOptions_ignoredIssues" checked>
                        Show Ignored Issues
                    </label>
                </div>
            </div>
        </div>

        <!-- Feature Toggles -->
        <div class="section">
            <h2>Feature Toggles</h2>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="enableSnykLearnCodeActions" checked>
                    Enable Snyk Learn Code Actions
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="enableSnykOSSQuickFixCodeActions" checked>
                    Enable Snyk OSS Quick Fix Code Actions
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="enableSnykOpenBrowserActions" checked>
                    Enable Snyk Open Browser Actions
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="enableDeltaFindings" checked>
                    Enable Delta Findings
                </label>
            </div>
        </div>

        <!-- Advanced Settings -->
        <div class="section">
            <h2>Advanced Settings</h2>

            <div class="form-group">
                <label for="snykCodeApi">Snyk Code API URL</label>
                <input type="text" id="snykCodeApi" name="snykCodeApi" value="https://deeproxy.snyk.io" placeholder="https://deeproxy.snyk.io">
            </div>

            <div class="form-group">
                <label for="additionalParams">Additional CLI Parameters (Legacy)</label>
                <input type="text" id="additionalParams" name="additionalParams" value="--severity-threshold=high" placeholder="--debug --severity-threshold=high">
                <span class="description">Use folder-specific additional parameters instead</span>
            </div>

            <div class="form-group">
                <label for="additionalEnv">Additional Environment Variables (Legacy)</label>
                <input type="text" id="additionalEnv" name="additionalEnv" value="DEBUG=snyk:*" placeholder="DEBUG=true">
                <span class="description">KEY=value format</span>
            </div>
        </div>

        <!-- Folder Specific Settings -->
        <div class="section">
            <h2>Folder Settings</h2>
            
            <div class="folder-config">
                <h3>Folder: /Users/username/workspace/my-project</h3>
                <input type="hidden" name="folder_0_folderPath" value="/Users/username/workspace/my-project">

                <div class="form-group">
                    <label for="folder_0_baseBranch">Base Branch</label>
                    <input type="text" id="folder_0_baseBranch" name="folder_0_baseBranch" value="main" placeholder="main">
                </div>

                <div class="form-group">
                    <label for="folder_0_localBranches">Local Branches</label>
                    <input type="text" id="folder_0_localBranches" name="folder_0_localBranches" value="feature/new-feature,bugfix/critical-fix" placeholder="feature-1,feature-2">
                    <span class="description">Comma-separated branch names</span>
                </div>

                <div class="form-group">
                    <label for="folder_0_additionalParameters">Additional CLI Parameters</label>
                    <input type="text" id="folder_0_additionalParameters" name="folder_0_additionalParameters" value="--all-projects --detection-depth=3" placeholder="--severity-threshold=high">
                    <span class="description">Space-separated arguments</span>
                </div>

                <div class="form-group">
                    <label for="folder_0_referenceFolderPath">Reference Folder Path</label>
                    <input type="text" id="folder_0_referenceFolderPath" name="folder_0_referenceFolderPath" value="/Users/username/workspace/reference-project" placeholder="/path/to/reference">
                </div>

                <div class="form-group">
                    <label for="folder_0_preferredOrg">Preferred Organization</label>
                    <input type="text" id="folder_0_preferredOrg" name="folder_0_preferredOrg" value="my-org-uuid-12345" placeholder="org-id">
                </div>

                <div class="form-group">
                    <label for="folder_0_autoDeterminedOrg">Auto-Determined Organization</label>
                    <input type="text" id="folder_0_autoDeterminedOrg" name="folder_0_autoDeterminedOrg" value="auto-detected-org-uuid" readonly>
                    <span class="description">Auto-populated</span>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="folder_0_orgMigratedFromGlobalConfig">
                        Organization Migrated from Global Config
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="folder_0_orgSetByUser" checked>
                        Organization Set by User
                    </label>
                </div>

                <div class="form-group">
                    <label for="folder_0_featureFlags">Feature Flags (JSON)</label>
                    <textarea id="folder_0_featureFlags" name="folder_0_featureFlags" rows="3" placeholder='{"flag": true}'>{"enableNewScanner": true, "betaFeatures": false}</textarea>
                    <span class="description">JSON object of feature flags</span>
                </div>

                <div class="form-group">
                    <label for="folder_0_sastSettings">SAST Settings (JSON)</label>
                    <textarea id="folder_0_sastSettings" name="folder_0_sastSettings" rows="3" placeholder='{}' readonly>{"enabled": true, "localCodeEngine": {"enabled": false}}</textarea>
                    <span class="description">Auto-populated SAST configuration</span>
                </div>

                <div class="form-group">
                    <label for="folder_0_scanCommandConfig">Scan Command Config (JSON)</label>
                    <textarea id="folder_0_scanCommandConfig" name="folder_0_scanCommandConfig" rows="3" placeholder='{}'>{"oss": {"enabled": true}, "code": {"enabled": true}}</textarea>
                    <span class="description">Product-specific scan configurations</span>
                </div>
            </div>

            <div class="folder-config">
                <h3>Folder: /Users/username/workspace/another-project</h3>
                <input type="hidden" name="folder_1_folderPath" value="/Users/username/workspace/another-project">

                <div class="form-group">
                    <label for="folder_1_baseBranch">Base Branch</label>
                    <input type="text" id="folder_1_baseBranch" name="folder_1_baseBranch" value="develop" placeholder="main">
                </div>

                <div class="form-group">
                    <label for="folder_1_localBranches">Local Branches</label>
                    <input type="text" id="folder_1_localBranches" name="folder_1_localBranches" value="feature/ui-improvements" placeholder="feature-1,feature-2">
                    <span class="description">Comma-separated branch names</span>
                </div>

                <div class="form-group">
                    <label for="folder_1_additionalParameters">Additional CLI Parameters</label>
                    <input type="text" id="folder_1_additionalParameters" name="folder_1_additionalParameters" value="" placeholder="--severity-threshold=high">
                    <span class="description">Space-separated arguments</span>
                </div>

                <div class="form-group">
                    <label for="folder_1_referenceFolderPath">Reference Folder Path</label>
                    <input type="text" id="folder_1_referenceFolderPath" name="folder_1_referenceFolderPath" value="" placeholder="/path/to/reference">
                </div>

                <div class="form-group">
                    <label for="folder_1_preferredOrg">Preferred Organization</label>
                    <input type="text" id="folder_1_preferredOrg" name="folder_1_preferredOrg" value="" placeholder="org-id">
                </div>

                <div class="form-group">
                    <label for="folder_1_autoDeterminedOrg">Auto-Determined Organization</label>
                    <input type="text" id="folder_1_autoDeterminedOrg" name="folder_1_autoDeterminedOrg" value="" readonly>
                    <span class="description">Auto-populated</span>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="folder_1_orgMigratedFromGlobalConfig">
                        Organization Migrated from Global Config
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="folder_1_orgSetByUser">
                        Organization Set by User
                    </label>
                </div>

                <div class="form-group">
                    <label for="folder_1_featureFlags">Feature Flags (JSON)</label>
                    <textarea id="folder_1_featureFlags" name="folder_1_featureFlags" rows="3" placeholder='{"flag": true}'>{}</textarea>
                    <span class="description">JSON object of feature flags</span>
                </div>

                <div class="form-group">
                    <label for="folder_1_sastSettings">SAST Settings (JSON)</label>
                    <textarea id="folder_1_sastSettings" name="folder_1_sastSettings" rows="3" placeholder='{}' readonly></textarea>
                    <span class="description">Auto-populated SAST configuration</span>
                </div>

                <div class="form-group">
                    <label for="folder_1_scanCommandConfig">Scan Command Config (JSON)</label>
                    <textarea id="folder_1_scanCommandConfig" name="folder_1_scanCommandConfig" rows="3" placeholder='{}'></textarea>
                    <span class="description">Product-specific scan configurations</span>
                </div>
            </div>
            
        </div>

        <div class="actions">
            <button type="button" id="save-config-btn" onclick="alert('✅ Save functionality: In the actual implementation, this calls ${ideSaveConfig}(jsonData) to save configuration via the IDE extension.\n\nThe updated constructSettingsFromConfig() now populates ALL 40+ settings from the config!')">Save Configuration</button>
            <button type="button" id="authenticate-btn" class="secondary" onclick="alert('✅ Authentication functionality: In the actual implementation, this saves the config and calls ${ideLogin}() to trigger the authentication flow.')">Authenticate</button>
        </div>
    </form>

    <script>
        // Demo version with alerts instead of actual IDE bindings
        console.log('Configuration Dialog Preview - User-Configurable Settings Only');
        console.log('✅ Dialog displays user-configurable settings:');
        console.log('  - Core Authentication (Token, Endpoint, Organization, Method, AutoAuth)');
        console.log('  - Product Activation (OSS, Code, IaC, CodeSecurity, CodeQuality)');
        console.log('  - CLI & Paths (CliPath, Path, ManageBinaries)');
        console.log('  - Security (Insecure, TrustedFolders, TrustedFoldersFeature)');
        console.log('  - Operational (ScanningMode, SendErrorReports)');
        console.log('  - Filters (FilterSeverity, IssueViewOptions, HoverVerbosity, OutputFormat)');
        console.log('  - Feature Toggles (Learn, OSSQuickFix, OpenBrowser, DeltaFindings)');
        console.log('  - Advanced (SnykCodeApi, Additional params/env)');
        console.log('  - Folder Configs (All 12 sub-fields)');
        console.log('');
        console.log('❌ System fields hidden (auto-populated by IDE):');
        console.log('  - IntegrationName, IntegrationVersion, DeviceId');
        console.log('  - OsPlatform, OsArch, RuntimeName, RuntimeVersion');
        console.log('  - RequiredProtocolVersion');
        console.log('');
        console.log('In production, IDE bindings:');
        console.log('- ${ideSaveConfig}(jsonData) - saves configuration');
        console.log('- ${ideLogin}() - triggers authentication');
        console.log('- ${ideLogout}() - triggers logout when endpoint changes');
    </script>
</body>
</html>
