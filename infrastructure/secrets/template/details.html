<!--
  ~ Â© 2026 Snyk Limited
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv='Content-Type' content='text/html; charset=unicode' />
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy"
    content="style-src 'self' 'nonce-{{.Nonce}}' 'nonce-ideNonce' 'sha256-xTz+BhbUie/RZ+GiIGx9ilUKue8VdBpNwgjwIbRfO/E=' https://fonts.googleapis.com;
             script-src 'nonce-{{.Nonce}}' https://fonts.googleapis.com;
             font-src 'self' https://fonts.gstatic.com;" />

  <style nonce="{{.Nonce}}">
    {{.Styles}}
  </style>
  <style nonce="{{.Nonce}}">
    ${ideStyle}
  </style>
</head>

<body>
  <!-- Panel header -->
  <section class="sn-issue-header">
    <!-- Ignore header -->
    {{if .IsIgnored}}
    <div class="sn-status-message mod-warning">
      <svg class="sn-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1.25199 12.9165C0.663992 14.0677 1.13999 15 2.31599 15H13.684C14.86 15 15.336 14.0758 14.748 12.9165L9.071 1.86645C8.476 0.71524 7.524 0.707133 6.929 1.86645L1.25899 12.9165H1.25199ZM9 13H7V11H9V13ZM9 10H7V6H9V10Z" fill="currentColor"/>
      </svg>

      <span>
        <strong>Ignored.</strong> This issue is currently ignored.
      </span>
    </div>
    {{end}}
    {{if .IsPending}}
    <div class="sn-status-message mod-warning">
      <svg class="sn-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1.25199 12.9165C0.663992 14.0677 1.13999 15 2.31599 15H13.684C14.86 15 15.336 14.0758 14.748 12.9165L9.071 1.86645C8.476 0.71524 7.524 0.707133 6.929 1.86645L1.25899 12.9165H1.25199ZM9 13H7V11H9V13ZM9 10H7V6H9V10Z" fill="currentColor"/>
      </svg>

      <span>
        This issue will be ignored once the request is approved.
      </span>
    </div>
    {{end}}
    <div class="sn-title-container">
      {{.SeverityIcon}}
      <h1 class="sn-issue-title">{{.IssueTitle}}</h1>
    </div>
    <div class="sn-issue-meta">
      <div class="severity-type">Secret</div>
      {{if .IgnoreLineAction}}
      <span class="delimiter"></span>
      <div>Position line: <a class="styled-link" id="position-line">{{.IgnoreLineAction}}</a></div>
      {{end}}
      {{if .RuleName}}
      <span class="delimiter"></span>
      <div>{{.RuleName}}</div>
      {{end}}
      {{if gt (len .CWEs) 0}}
      <span class="delimiter"></span>
      {{range $index, $cwe := .CWEs}}
      <a class="cwe styled-link" rel="noopener noreferrer"
        href="https://cwe.mitre.org/data/definitions/{{trimCWEPrefix $cwe}}.html">{{$cwe}}</a>
      {{if ne $index (idxMinusOne (len $.CWEs))}}<span class="delimiter"></span>{{end}}
      {{end}}
      {{end}}
      {{if .IsIgnored}}<div class="sn-ignore-badge">IGNORED</div>{{end}}
      {{if .IsPending}}<div class="sn-ignore-badge">PENDING IGNORE</div>{{end}}
    </div>
  </section>

  <main class="code-issue-container">
    <!-- Tabs Issue Container -->
    <article class="code-issue-panel">
      <div class="main-tabs-nav">
        {{if not .IsIgnored}}
        <span data-tab="details" id="details-tab"
          class="tab-item {{if not .IsPending}}is-selected{{end}} fix-analysis-tab">
          Issue Overview
        </span>
        {{end}}
        {{if or .IsIgnored .IsPending}}
        <span data-tab="ignore-details" id="ignore-details-tab" class="tab-item is-selected ignore-details-tab">
          Ignore Details
        </span>
        {{end}}
      </div>

      <!-- Dynamic Content Sections -->
      <div class="tab-container">
        {{if or .IsIgnored .IsPending}}
        <!-- Start Ignore Details section -->
        <div data-content="ignore-details" id="ignore-details-content" class="tab-content main-tab-content is-selected">
          <div class="ignore-details delimiter-top">
            <table class="ignore-details-table">
              {{range .IgnoreDetails}}
              <tr class="ignore-details-row">
                <td class="ignore-details-label">{{.Label}}</td>
                <td class="ignore-details-value">{{.Value}}</td>
              </tr>
              {{end}}
            </table>
            <div class="ignore-next-step-text">
              Ignores are currently managed in the Snyk web app.
              To edit or remove the ignore please go to:
              <a class="styled-link" href="{{.SnykWebUrl}}"
                rel="noopener noreferrer">{{.SnykWebUrl}}</a>.
            </div>
          </div>
        </div>
        {{end}}
        <!-- End Ignore Details section -->

        <!-- Start Details section -->
        <div data-content="details" id="details-content"
          class="tab-content main-tab-content {{if and (not .IsIgnored) (not .IsPending)}}is-selected{{end}}">
          <section id="suggestion-info" class="delimiter-top">
            <div id="description" class="suggestion-text">{{.IssueMessage}}</div>
          </section>
          <section class="delimiter-top">
            <h2>DETAILS AND REMEDIATION</h2>
            <div>
             <h3>Why this is dangerous</h3>
              <p>Attackers can discover hardcoded credentials in source code to gain unauthorized access, escalate privileges, steal data, or disrupt services. If you reuse credentials across systems or environments, the impact increases.</p>
            <h3>Immediate action</h3>
              <ul>
                <li>Treat hardcoded credentials as compromised.</li>
                <li>Remove the credentials from the code and commit history.</li>
                <li>Rotate or revoke the credential and update all affected systems.</li>
                <li>Store the new secret in a secrets manager or vault, or inject the secret using environment variables at runtime.</li>
              </ul>
              <h3>Preventing future exposure</h3>
              <ul>
                <li>Do not hardcode secrets.</li>
                <li>Use pre-commit hooks and automated secrets scanning to prevent accidental commits.</li>
                <li>Use secrets management tools, such as vaulting, environment injection, or secure configuration.</li>
                <li>Use least-privilege credentials and strong salted hashes for stored passwords.</li>
                <li>Add secure authentication practices to the development workflow.</li>
              </ul>
            </div>
          </section>
        </div>
        <!-- End Details section -->
      </div>
    </article>
  </main>

  {{if and (.CCIEnabled) (not .IsIgnored) (not .IsPending)}}
  <div id="ignore-form-container" class="sn-ignore-issue-container hidden">
    <h2 class="sn-ignore-title">Ignore this issue</h2>
    <p class="sn-ignore-description">This ignore will reflect once it has been approved.</p>

    <div class="sn-field">
      <div class="sn-label">Ignore type</div>
      <select class="sn-select" id="ignore-form-type">
        <option value="not-vulnerable">Not vulnerable</option>
        <option value="wont-fix">Won't fix</option>
        <option value="temporary-ignore">Temporary ignore</option>
      </select>
    </div>

    <div class="sn-field">
      <div class="sn-label">Expiration</div>
      <select class="sn-select" id="ignore-form-expiration-type">
        <option value="never">Never</option>
        <option value="custom-expiration-date">Custom expiration date</option>
      </select>
      <input class="sn-input hidden" id="ignore-form-expiration-date" type="date" value="">
    </div>

    <div id="ignore-reason-error" class="sn-error-badge hidden">Please provide a reason for ignoring this issue.</div>
    <div class="sn-field">
      <div class="sn-label">Ignore reason</div>
      <textarea class="sn-textarea" id="ignore-form-ignore-reason" rows="4" placeholder="Please provide a reason for ignoring this issue"></textarea>
    </div>

    <div class="sn-field mod-right-aligned">
      <button id="ignore-form-submit" class="sn-button">Submit ignore</button>
      <button id="ignore-form-cancel" class="sn-button mod-ghost">Cancel</button>
    </div>
  </div>
  {{end}}

  <!-- Ignore Actions -->
  {{if and (not .IsIgnored) (not .IsPending)}}
  <footer class="ignore-action-container">
    <div id="ignore-actions">
      {{if .CCIEnabled}}
      <div id="ignore-cci-actions" class="actions row">
        <button id="ignore-create" class="ignore-button secondary">Create ignore</button>
      </div>
      {{end}}
    </div>
  </footer>
  {{end}}

  <!-- Scripts -->
  <script nonce="{{.Nonce}}">
    var MAIN_TAB_NAV_SELECTOR = '.main-tabs-nav';
    var MAIN_TAB_ITEM_SELECTOR = '.main-tabs-nav .tab-item';
    var MAIN_TAB_CONTENT_SELECTOR = '.tab-container > .main-tab-content';

    function toggleIsSelectedClass(elements, shouldToggle) {
      if (!elements) return;
      for (var i = 0; i < elements.length; i++) {
        var el = elements[i];
        if (shouldToggle(el)) {
          if (el.className.indexOf('is-selected') === -1) {
            el.className += ' is-selected';
          }
        } else {
          el.className = el.className.replace(/(?:^|\s)is-selected(?!\S)/g, '');
        }
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      var mainTabLinks = document.querySelectorAll(MAIN_TAB_ITEM_SELECTOR);
      var mainTabContents = document.querySelectorAll(MAIN_TAB_CONTENT_SELECTOR);
      var mainTabNav = document.querySelector(MAIN_TAB_NAV_SELECTOR);

      if (mainTabNav) {
        mainTabNav.onclick = function (event) {
          var clickedTab = event.target.closest('.tab-item');
          if (!clickedTab) return;
          var selectedTab = clickedTab.getAttribute('data-tab');

          toggleIsSelectedClass(mainTabLinks, function (tab) {
            return tab === clickedTab;
          });
          toggleIsSelectedClass(mainTabContents, function (content) {
            return content.getAttribute('data-content') === selectedTab;
          });
        };
      }
    });
  </script>
  {{if and (.CCIEnabled) (not .IsIgnored) (not .IsPending)}}
  <script nonce="{{.Nonce}}">
    // Polyfill for datepicker from https://brianblakely.github.io/nodep-date-input-polyfill/nodep-date-input-polyfill.dist.js taken 28th April 2025
    // Creates a style with the hash: sha256-xTz+BhbUie/RZ+GiIGx9ilUKue8VdBpNwgjwIbRfO/E=
    (function(a,b){'object'==typeof exports&&'undefined'!=typeof module?b():'function'==typeof define&&define.amd?define(b):b()})(this,function(){'use strict';(function(a){if(a&&'undefined'!=typeof window){var b=document.createElement('style');return b.setAttribute('type','text/css'),b.innerHTML=a,document.head.appendChild(b),a}})('date-input-polyfill {\n  background: #fff;\n  color: #000;\n  text-shadow: none;\n  border: 0;\n  padding: 0;\n  height: auto;\n  width: auto;\n  line-height: normal;\n  border-radius: 0;\n  font-family: sans-serif;\n  font-size: 14px;\n  position: absolute !important;\n  text-align: center;\n  box-shadow: 0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 12px 17px 2px rgba(0, 0, 0, 0.14), 0 5px 22px 4px rgba(0, 0, 0, 0.12);\n  cursor: default;\n  z-index: 1; }\n  date-input-polyfill[data-open="false"] {\n    display: none; }\n  date-input-polyfill[data-open="true"] {\n    display: block; }');});
  </script>
  {{end}}
  <!-- Embedded script from LS -->
  <script nonce="{{.Nonce}}">
    var issueId = "{{.IssueId}}"
    {{.Scripts}}
  </script>
  <!-- Custom IDE specific scripts -->
  <script nonce="{{.Nonce}}">
    ${ideScript}
  </script>
</body>

</html>
