<!--
  ~ © 2024 Snyk Limited
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'none'; style-src 'self' 'nonce-${nonce}'; script-src 'nonce-${nonce}';" />

  <style nonce="${nonce}">
    :root {
      --default-font: "SF Pro Text", "Segoe UI", "Ubuntu", Tahoma, Geneva, Verdana, sans-serif;
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-thumb {
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #595a5c;
    }

    *,
    *:before,
    *:after {
      box-sizing: border-box;
    }

    body {
      font-family: var(--default-font);
      overflow-y: auto;
      overflow-x: hidden;
    }

    h2 {
      font-weight: 600;
      margin-bottom: 10px;
    }

    main {
      flex: 1 0 auto;
      overflow-y: auto;
    }

    .arrow  {
      margin: 3px;
      cursor: pointer;
    }

    .ignore-warning-wrapper,
    header,
    article,
    footer {
      padding: 0px 20px 5px 20px;
    }

    .panel-header {
      display: flex;
      flex-direction: column;
    }

    .code-issue-panel {
      margin-bottom: 30px;
    }

    .example-fixes-header,
    .issue-overview-header,
    .ignore-details-header,
    .data-flow-header,
    .ai-fix-header,
    .overview-text > h2 {
      line-height: 1.25rem;
      font-size: 1.2rem;
      margin-bottom: 10px;
    }

    .severity-title {
      padding-left: 8px;
    }

    .severity-container {
      display: flex;
      flex-direction: row;
      align-items: center;
      margin-bottom: 3px;
    }

    .severity-type-container {
      display: flex;
      flex-direction: row;
      align-items: center;
      margin-bottom: 1em;
      line-height: 1em;
    }

    .lesson-container {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }

    .lesson-icon {
      display: flex;
      align-items: center;
    }

    .lesson-link {
      display: flex;
      align-items: center;
    }

    .is-external {
      padding-right: 12px;
    }

    .is-external-icon {
      margin-bottom: 8px;
      margin-left: 4px;
    }

    .styled-link {
      text-decoration: none;
    }

    .styled-link:hover {
      cursor: pointer;
      text-decoration: underline;
    }

    .delimiter {
      margin: 0 8px;
    }

    .ignore-warning-icon {
      margin-right: 0.5em;
    }

    .ignore-warning-wrapper {
      display: flex;
      align-items: center;
    }

    .ignore-warning {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      line-height: 1.125rem;
      padding: 0.5em;
      border-radius: 0.25em;
      width: 100%;
      box-sizing: border-box;
    }

    .ignore-badge {
      padding: 0.35em 0.35em;
      border-radius: 0.25em;
      margin-left: 1em;
    }

    .data-flow-file {
      font-weight: bold;
      font-size: 1em;
      display: flex;
      align-items: center;
      margin-top: 5px;
    }

    .data-flow-file-icon {
      margin-left: 4px;
      margin-right: 4px;
    }

    .data-flow-body {
      margin-top: 5px;
      margin-bottom: 10px;
    }

    .data-flow-table {
      margin-top: 5px;
      margin-left: 15px;
    }

    .data-flow-row {
      border-collapse: collapse;
      vertical-align: baseline;
    }

    .data-flow-number {
      padding-left: 14px;
      padding-right: 14px;
      width: 0.9375rem;
      text-align: right;
    }

    .data-flow-clickable-row {
      font-weight: 400;
      width: 3.9375rem;
      text-align: right;
    }

    .data-flow-clickable-row:hover {
      cursor: pointer;
      text-decoration: underline;
    }

    .data-flow-text {
      margin-right: 8px;
      font-weight: 400;
      word-break: break-all;
    }

    .data-flow-delimiter {
      opacity: 0.5;
    }

    .main-tabs-nav,
    .tabs-nav {
      display: flex;
      list-style-type: none;
      overflow: hidden;
      padding: 0;
    }

    .tab-content {
      display: none;
      border-top-style: hidden;
    }

    .tab-content.is-selected {
      display: block;
    }

    .tab-item-icon {
      vertical-align: middle;
    }

    .tab-item {
      font-weight: 500;
      float: left;
      display: block;
      text-align: center;
      padding: 10px 16px 8px 16px;
      text-decoration: none;
      margin-right: 4px;
      cursor: pointer;
      transition: background-color 0.3s, border-color 0.3s;
    }

    .tab-item-icon {
      color: inherit;
    }

    .example-fixes h2 {
      margin-bottom: 0.5em;
    }

    .example-fixes-info-top {
      margin-bottom: 0.5em;
    }

    .example {
      margin-top: 0.75rem;
    }

    .example-repo-link {
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }

    .example-repo-link:hover {
      text-decoration: none;
      color: inherit;
    }

    .example-repo-link a {
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }

    .example-repo-link a:hover {
      text-decoration: none;
      color: inherit;
    }

    .example-line {
      display: block;
      position: relative;
      padding-left: 20px;
    }

    .example-line>code {
      padding-left: 0.75rem;
      font-family: "Courier New", Courier, monospace;
      display: inline-block;
      white-space: pre-wrap;
      font-weight: 400;
      background-color: transparent;
    }

    .example-line.added>code::before,
    .example-line.removed>code::before {
      position: absolute;
      left: 5px;
      top: 50%;
      transform: translateY(-50%);
    }

    .example-line.added>code::before {
      content: "+";
    }

    .example-line.removed>code::before {
      content: "-";
    }

    /* Footer Styles */
    .ignore-action-container {
      position: fixed;
      bottom: 0;
      width: 100%;
      margin-block-end: 0;
    }

    #ignore-actions {
      margin-top: 10px;
      margin-bottom: 5px;
    }

    .actions {
      justify-content: space-between;
      display: flex;
    }

    .row {
      display: flex;
      flex-direction: row;
      width: 100%;
    }

    .ignore-button.secondary {
      cursor: pointer;
      width: auto;
      padding: 6px 16px;
      border-radius: 3px;
      background: none;
      line-height: 1;
    }

    .ignore-details {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      padding: 20px 0;
      gap: 12px;
      box-sizing: border-box;
      width: 100%;
    }

    .ignore-details-row {
      display: flex;
      justify-content: space-between;
      width: 100%;
      align-items: flex-start;
    }

    .ignore-details-row {
      display: flex;
      justify-content: space-between;
      width: 100%;
      align-items: flex-start;
    }

    .ignore-details-label {
      width: 30%;
      text-align: left;
      font-weight: bold;
      padding-right: 10px;
    }

    .ignore-details-value {
      flex-grow: 1;
      text-align: left;
      align-self: stretch;
    }

    button,
    .button {
      border-radius: 3px;
    }

    /*AI fix tab */
    .row.between {
      justify-content: space-between;
    }

    .row {
      display: flex;
      flex-direction: row;
      width: 100%;
    }

    .suggestion-text {
      padding: 0.4rem 0;
      line-height: 1.6;
    }

    .suggestion-links {
      display: flex;
      width: 100%;
      line-height: 1;
    }

    .ai-fix {
      padding-bottom: 0;
    }

    .ai-fix p {
      margin-bottom: 0;
    }

    .sn-fix-wrapper {
      padding: 2rem;
      margin-top: 1rem;
      border-radius: 0.8rem;
      overflow: hidden;
    }

    .generate-ai-fix {
      width: auto;
      padding: 8px 16px;
    }

    .sn-apply-fix {}

    .sn-readmore {
      margin-top: 1.6rem;
    }

    .sn-loading {
      display: flex;
    }

    .sn-loading svg {
      inline-size: 6rem;
      block-size: auto;
    }

    .sn-loading-wrapper {
      position: relative;
      display: flex;
      flex-direction: column;
      width: 100%;
    }

    .sn-loading-message {
      opacity: 0;
      position: absolute;
      width: 100%;
      padding-left: 16px;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .sn-loading-title {
      font-weight: 600;
      line-height: 1.5;
    }

    .sn-loading-description {
      margin-bottom: 0;
      opacity: 0.75;
    }

    .sn-msg-1 {
      animation: reduce 4s ease-in;
    }

    .sn-msg-2 {
      animation: reduce 4s ease-in;
      animation-delay: 4s;
    }

    .sn-msg-3 {
      animation: reduce 4s ease-in;
      animation-delay: 8s;
    }

    .sn-msg-4 {
      animation: inference 4s ease-in infinite;
      animation-delay: 12s;
    }

    #s0 {
      animation: s0ani 3000ms linear infinite;
    }

    #l1 {
      animation: l1ani 3000ms linear infinite;
    }

    #l2 {
      animation: l2ani 3000ms linear infinite;
    }

    #l3 {
      animation: l3ani 3000ms linear infinite;
    }

    #b1 {
      animation: b1ani 3000ms linear infinite;
    }

    #b2 {
      animation: b2ani 3000ms linear infinite;
    }

    #b3 {
      animation: b3ani 3000ms linear infinite;
    }

    @keyframes s0ani {
      0% {
        transform: translate(50%, -15%);
      }

      100% {
        transform: translate(50%, 115%);
      }
    }

    @keyframes l1ani {

      0%,
      23% {
        fill: rgba(255, 255, 255, 0.2);
      }

      40%,
      100% {
        fill: rgba(249, 122, 153, 0.6);
      }
    }

    @keyframes l2ani {

      0%,
      40% {
        fill: rgba(255, 255, 255, 0.2);
      }

      56%,
      100% {
        fill: rgba(249, 122, 153, 0.6);
      }
    }

    @keyframes l3ani {

      0%,
      56% {
        fill: rgba(255, 255, 255, 0.2);
      }

      72%,
      100% {
        fill: rgba(67, 181, 154, 0.6);
      }
    }

    @keyframes b1ani {

      0%,
      8% {
        opacity: 0;
        transform: scale(1, 1);
      }

      33% {
        transform: translate(-10%, -18%) scale(1.6, 1.6);
      }

      53%,
      100% {
        opacity: 1;
        transform: scale(1, 1);
      }
    }

    @keyframes b2ani {

      0%,
      36% {
        opacity: 0;
        transform: scale(1, 1);
      }

      50% {
        transform: translate(-20%, -18%) scale(1.4, 1.4);
      }

      60%,
      100% {
        opacity: 1;
        transform: scale(1, 1);
      }
    }

    @keyframes b3ani {

      0%,
      54% {
        opacity: 0;
        transform: scale(1, 1);
      }

      66% {
        transform: translate(-10%, -27%) scale(1.4, 1.4);
      }

      76%,
      100% {
        opacity: 1;
        transform: scale(1, 1);
      }
    }

    @keyframes reduce {

      15%,
      85% {
        opacity: 1;
      }

      86%,
      100%,
      0% {
        opacity: 0;
      }
    }

    @keyframes inference {

      0%,
      25%,
      100% {
        opacity: 1;
      }
    }

    .hidden {
      display: none;
    }
  </style>

  ${ideStyle}
</head>

<body>
  <!-- Ignore header -->
  {{if .IsIgnored}}
  <div class="ignore-warning-wrapper">
    <div class="ignore-warning ">
      <svg class="ignore-warning-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
        <path d="M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16" fill="#D68000" />
      </svg>
      <span><strong>Ignored.</strong> This issue is currently ignored.</span>
    </div>
  </div>
  {{end}}
  <!-- Panel header -->
  <header class="panel-header">
    <div class="severity-container">
      {{.SeverityIcon}}
      <h2 class="severity-title">{{.IssueTitle}}</h2>
    </div>
    <div class="severity-type-container">
      <div class="severity-type">{{.IssueType}}</div>
      {{if gt (len .CWEs) 0}}
      <span class="delimiter">|</span>
      {{range $index, $cwe := .CWEs}}
      <a class="cwe styled-link" target="_blank" rel="noopener noreferrer"
        href="https://cwe.mitre.org/data/definitions/{{trimCWEPrefix $cwe}}.html">{{$cwe}}</a>
      {{if ne $index (idxMinusOne (len $.CWEs))}}<span class="delimiter"></span>{{end}}
      {{end}}
      {{end}}
      {{if .IgnoreLineAction}}
      <span class="delimiter">|</span>
      <div>Position line: <a class="styled-link" id="position-line">{{.IgnoreLineAction}}</a></div>
      {{end}}
      {{if ge .PriorityScore 0}}
      <span class="delimiter">|</span>
      <div>Priority score: {{.PriorityScore}}</div>
      {{end}}
      {{if .IsIgnored}}<div class="ignore-badge">IGNORED</div>{{end}}
    </div>
    {{if .LessonUrl}}
    <div class="lesson-container">
      <div class="lesson-icon">
        {{.LessonIcon}}
      </div>
      <a class="lesson-link styled-link is-external" target="_blank" rel="noopener noreferrer" href="{{.LessonUrl}}">
        Learn about this vulnerability
        {{.ExternalIcon}}
      </a>
    </div>
    {{end}}
  </header>

  <main class="code-issue-container">
    <!-- Tabs Issue Overview Container -->
    <article class="code-issue-panel">
      <div class="main-tabs-nav">
        {{if .IsIgnored}}
        <span data-tab="ignore-details" id="ignore-details-tab" class="tab-item is-selected ignore-details-tab">
          Ignore Details
        </span>
        {{end}}
        <span data-tab="fix-analysis" id="fix-analysis-tab"
          class="tab-item {{if not .IsIgnored}}is-selected{{end}} sn-fix-analysis fix-analysis-tab">
          Fix Analysis
        </span>
        <span data-tab="vuln-overview" id="vuln-overview-tab" class="tab-item sn-vuln-overview vuln-overview-tab">
          Vulnerability Overview
        </span>
      </div>

      <!-- Dynamic Content Sections -->
      <div class="tab-container">
        {{if .IsIgnored}}
        <!-- Start Ignore Details section for tab id="ignore-details-tab" -->
        <div data-content="ignore-details" id="ignore-details-content" class="tab-content main-tab-content is-selected">
          <div class="ignore-details delimiter-top">
            {{range .IgnoreDetails}}
            <div class="ignore-details-row">
              <div class="ignore-details-label">{{.Label}}</div>
              <div class="ignore-details-value">{{.Value}}</div>
            </div>
            {{end}}
            <div class="ignore-next-step-text">
              Ignores are currently managed in the Snyk web app.
              To edit or remove the ignore please go to:
              <a class="styled-link" href="{{.SnykWebUrl}}" target="_blank"
                rel="noopener noreferrer">{{.SnykWebUrl}}</a>.
            </div>
          </div>
        </div>
        {{end}}
        <!-- End Ignored Details section -->

        <!-- Start Fix Analysis section for tab id="fix-analysis-tab" -->
        <div data-content="fix-analysis" id="fix-analysis-content"
          class="tab-content main-tab-content {{if not .IsIgnored}}is-selected{{end}}">
          <section id="suggestion-info" class="delimiter-top">
            <div id="description" class="suggestion-text">{{.IssueMessage}}</div>
            <div class="suggestion-links">
              <div id="lead-url" class="clickable hidden">
                <svg width="9" height="9" viewBox="0 0 9 9" xmlns="http://www.w3.org/2000/svg" fill="none">
                  <path d="M4.99998 0L6.64648 1.6465L3.14648 5.1465L3.85348 5.8535L7.35348 2.3535L8.99998 4V0H4.99998Z"
                    fill="#888" />
                  <path
                    d="M8 8H1V1H4.5L3.5 0H1C0.4485 0 0 0.4485 0 1V8C0 8.5515 0.4485 9 1 9H8C8.5515 9 9 8.5515 9 8V5.5L8 4.5V8Z"
                    fill="#888" />
                </svg> More info
              </div>
            </div>
          </section>

          <!-- AI Fix -->
          <div id="ai-fix-wrapper" class="{{if not .HasAIFix}}hidden{{end}}">
            <!-- AI fix buttons -->
            <section id="fix-wrapper" class="ai-fix delimiter-top">
              <h2 class="ai-fix-header">
                DeepCode AI Fixes
              </h2>

              <p>⚡ Fix this issue by generating a solution using Snyk DeepCode AI</p>

              <div class="sn-fix-wrapper">
                <button id="generate-ai-fix" class="generate-ai-fix">✨ Generate fix <span class="wide">using Snyk
                    DeepCode AI</span></button>

                <div id="fix-loading-indicator" class="sn-loading hidden">
                  <div class="sn-loading-icon">
                    {{.ScanAnimation}}
                  </div>
                  <div class="sn-loading-wrapper">
                    <div class="sn-loading-message sn-msg-1">
                      <span class="sn-loading-title">1<span class="font-light">/4</span> Code Reduction...</span>
                      <p class="sn-loading-description">Reduces the given files to a smaller and relevant code snippet.
                      </p>
                    </div>
                    <div class="sn-loading-message sn-msg-2">
                      <span class="sn-loading-title">2<span class="font-light">/4</span> Parsing...</span>
                      <p class="sn-loading-description">Analyzing symbols and generating the graph representation.</p>
                    </div>
                    <div class="sn-loading-message sn-msg-3">
                      <span class="sn-loading-title">3<span class="font-light">/4</span> Static Analysis...</span>
                      <p class="sn-loading-description">Examining the vulnerability code without having to execute the
                        program.</p>
                    </div>
                    <div class="sn-loading-message sn-msg-4">
                      <span class="sn-loading-title">4<span class="font-light">/4</span> Inferencing...</span>
                      <p class="sn-loading-description">Feeding the reduced code to our neural network to obtain the
                        prediction.</p>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <!-- AI fixes -->
            <section id="fixes-section" class="sn-ai-fixes delimiter-top hidden">
              <div id="info-no-diffs" class="font-light">
                There are no fix diffs for this issue.
              </div>
              <div id="diff-top" class="row between">
                <div id="info-top" class="font-light">Here are <span id="diff-number"></span> AI-generated solutions:
                </div>
                <div class="diffs-nav">
                  <span id="previous-diff" class="arrow" title="Previous diff">
                    {{.ArrowLeftDark}}
                    {{.ArrowLeftLight}}
                  </span>
                  <span id="diff-text">
                    AI solution <strong id="diff-counter">1</strong>/<span id="diff-number2"></span>
                  </span>
                  <span id="next-diff" class="arrow" title="Next diff">
                    {{.ArrowRightDark}}
                    {{.ArrowRightLight}}
                  </span>
                </div>
              </div>
              <div id="diff"></div>
              <button id="apply-fix" class="button sn-apply-fix">Apply fix</button>
            </section>

            <!-- AI fix errors -->
            <section id="fixes-error-section" class="sn-ai-fix-error delimiter-top hidden">
              <div id="info-no-diffs" class="font-light">
                ⚠️ There was an issue generating the fix
              </div>
              <div class="sn-fix-wrapper">
                <button id="retry-generate-fix" class="button generate-ai-fix">✨ Retry generating AI fixes</button>
              </div>
            </section>
          </div>

          <!-- Data Flow and Fixed Code Examples -->
          <div id="no-ai-fix-wrapper" class="{{if .HasAIFix}}hidden{{end}}">
            <!-- Data Flow -->
            <section class="data-flow-section delimiter-top">
              <h2 class="data-flow-header">
                Data Flow - {{len .DataFlow}} {{if gt (len .DataFlow) 1}}steps{{else}}step{{end}}
              </h2>
              <div class="data-flow-body">
                {{range $fileName, $dataFlowItems := .DataFlowTable}}
                <div class="data-flow-file">
                  {{$.FileIcon}}
                  <span class="data-flow-file-name">{{$fileName}}</span>
                </div>
                <table class="data-flow-table">
                  <tbody>
                      {{range $dataFlowItems}}
                      <tr class="data-flow-row">
                        <td class="data-flow-number">{{.Number}}</td>
                        <td class="data-flow-clickable-row" file-path="{{.FilePath}}" start-line="{{.StartLine}}"
                          end-line="{{.EndLine}}" start-character="{{.StartCharacter}}" end-character="{{.EndCharacter}}">
                          line:{{.StartLineValue}}
                        </td>
                        <td class="delimiter data-flow-delimiter">|</td>
                        <td class="data-flow-text">{{.Content}}</td>
                      </tr>
                      {{end}}
                  </tbody>
                </table>
                {{end}}
              </div>
            </section>

            <!-- Fixed Code Examples -->
            <section class="example-fixes delimiter-top">
              <h2 class="example-fixes-header">Fixed Code Examples</h2>
              {{if eq (len .ExampleCommitFixes) 0}}
              <div id="info-no-examples" class="font-light">
                No example fixes are available.
              </div>
              {{else}}
              <p id="example-fixes-info-top" class="example-fixes-info-top font-light">
                This type of vulnerability was fixed in {{.RepoCount}} open source projects.
              </p>
              <div id="example-top" class="row between">
                <div id="current-example" class="repo clickable">
                  {{.GitHubIcon}}
                  <span id="example-link" class="example-repo-link">
                    <a id="example-repo-anchor" href="{{(index .ExampleCommitFixes 0).RepoLink}}" target="_blank"
                      rel="noopener noreferrer">
                      {{(index .ExampleCommitFixes 0).RepoName}}
                    </a>
                  </span>
                </div>
                <div class="examples-nav">
                  <span id="previous-example" class="arrow" title="Previous example">
                    {{.ArrowLeftDark}}
                    {{.ArrowLeftLight}}
                  </span>
                  <span id="example-text">
                    Example <strong id="example-counter">1</strong>/<span id="example-number2">{{.ExampleCount}}</span>
                  </span>
                  <span id="next-example" class="arrow" title="Next example">
                    {{.ArrowRightDark}}
                    {{.ArrowRightLight}}
                  </span>
                </div>
              </div>

              <div id="example" class="example">
                {{range $index, $element := .ExampleCommitFixes}}
                <div class="example-detail {{if ne $index 0}}hidden{{end}}" data-index=" {{$index}}">
                  <div>
                    {{range $element.ExampleLines}}
                    <div class="example-line {{.LineChange}}">
                      <code>{{.Line}}</code>
                    </div>
                    {{end}}
                  </div>
                </div>
                {{end}}
              </div>
              {{end}}
            </section>
          </div>
        </div>
        <!-- End Fix Analysis section -->

        <!-- Start Vulnerability Overview section for tab id="vuln-overview-tab" -->
        <div id="vuln-overview-content" class="tab-content main-tab-content" data-content="vuln-overview">
          <!-- Content for Vulnerability Overview -->
          <section class="issue-overview delimiter-top">
            <div class="overview-text">
              {{.IssueOverview}}
            </div>
          </section>
        </div>
        <!-- End Vulnerability Overview section -->
      </div>
    </article>
  </main>

  <!-- Ignore In Line Actions -->
  {{if not .IsIgnored}}
  <footer class="ignore-action-container">
    <div id="ignore-actions">
      <div class="actions row">
        <button id="ignore-line-issue" class="ignore-button secondary">Ignore on line <span
            id="action-ignore-line">{{.IgnoreLineAction}}</span></button>
        <button id="ignore-file-issue" class="ignore-button secondary">Ignore in this file</button>
      </div>
    </div>
  </footer>
  {{end}}

  <!-- Scripts -->
  <script nonce="${nonce}">
    /**
     * Represents a single line change in a commit.
     * @typedef {Object} ExampleLine
     * @property {number} LineNumber  - The line number of the change.
     * @property {string} Line        - The content of the line.
     * @property {string} LineChange  - The type of change ('added' or 'removed').
     */

    /**
     * Represents a commit fix with detailed change lines.
     * @typedef {Object} ExampleCommitFix
     * @property {string} CommitURL           - URL to the full commit diff.
     * @property {string} RepoName            - Name of the repository.
     * @property {string} RepoLink            - Direct link to the repository.
     * @property {ExampleLine[]} ExampleLines - An array of line changes.
     */

    // Constants for class and ID names
    const MAIN_TAB_NAV_SELECTOR = '.main-tabs-nav';
    const MAIN_TAB_ITEM_SELECTOR = '.main-tabs-nav .tab-item';
    const MAIN_TAB_CONTENT_SELECTOR = '.tab-container > .main-tab-content';

    const EXAMPLE_COUNTER = 'example-counter';
    const EXAMPLE_PREVIOUS = 'previous-example';
    const EXAMPLE_NEXT = 'next-example';
    const EXAMPLE_REPO_ANCHOR = 'example-repo-anchor';
    const ALL_EXAMPLES_DETAIL = '.example-detail';

    // Utility functions
    const toggleIsSelectedClass = (elements, shouldToggle) => {
      elements.forEach(el => {
        // toggle(token, force) - force is a boolean value that determines whether the class should be added or removed.
        el.classList.toggle('is-selected', shouldToggle(el));
      });
    };

    function toggleElement(element, toggle) {
      if (!element) {
        return;
      }

      if (toggle === 'show') {
        element.classList.remove('hidden');
      } else if (toggle === 'hide') {
        element.classList.add('hidden');
      } else {
        console.error('Unexpected toggle value', toggle);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      const exampleCounter = document.getElementById(EXAMPLE_COUNTER);
      const examplePrevious = document.getElementById(EXAMPLE_PREVIOUS);
      const exampleNext = document.getElementById(EXAMPLE_NEXT);
      const exampleRepoAnchor = document.getElementById(EXAMPLE_REPO_ANCHOR);
      const allExamplesDetail = document.querySelectorAll(ALL_EXAMPLES_DETAIL);
      const mainTabLinks = document.querySelectorAll(MAIN_TAB_ITEM_SELECTOR);
      const mainTabContents = document.querySelectorAll(MAIN_TAB_CONTENT_SELECTOR);
      const mainTabNav = document.querySelector(MAIN_TAB_NAV_SELECTOR);

      let exampleCount = 0;

      /** @type {ExampleCommitFix[]} */
      const exampleCommitFixes = JSON.parse("{{.CommitFixes}}" || '[]');

      // Functions dependent on the DOM
      function showCurrentExample() {
        allExamplesDetail.forEach((example, idx) => {
          if (idx === exampleCount) {
            example.classList.remove('hidden');
          } else {
            example.classList.add('hidden');
          }
        });

        exampleCounter.textContent = exampleCount + 1;
        const repoName = exampleCommitFixes[exampleCount].RepoName;
        const repoLink = exampleCommitFixes[exampleCount].RepoLink;

        exampleRepoAnchor.textContent = repoName;
        exampleRepoAnchor.href = repoLink;
      }

      function previousExample() {
        if (exampleCount > 0) {
          exampleCount--;
          showCurrentExample();
        }
      }

      function nextExample() {
        if (exampleCount < exampleCommitFixes.length - 1) {
          exampleCount++;
          showCurrentExample();
        }
      }

      const onMainTabClicked = event => {
        const clickedTab = event.target.closest('.tab-item');
        if (!clickedTab) return;

        const selectedTab = clickedTab.getAttribute('data-tab');

        // Toggle selected tab and content
        toggleIsSelectedClass(mainTabLinks, tab => tab === clickedTab);
        toggleIsSelectedClass(mainTabContents, content => content.getAttribute('data-content') === selectedTab);
      };

      // Event listeners
      mainTabNav.addEventListener('click', onMainTabClicked);
      examplePrevious.addEventListener('click', previousExample);
      exampleNext.addEventListener('click', nextExample);

      // Initial function calls
      showCurrentExample();
    });
  </script>
  ${ideScript}
</body>

</html>
