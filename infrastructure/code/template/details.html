<!--
  ~ © 2024 Snyk Limited
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv='Content-Type' content='text/html; charset=unicode' />
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy"
    content="style-src 'self' 'nonce-{{.Nonce}}' 'nonce-ideNonce' 'sha256-xTz+BhbUie/RZ+GiIGx9ilUKue8VdBpNwgjwIbRfO/E=' https://fonts.googleapis.com;
             script-src 'nonce-{{.Nonce}}' https://fonts.googleapis.com;
             font-src 'self' https://fonts.gstatic.com;" />

  <style nonce="{{.Nonce}}">
    {{.Styles}}
  </style>
  <style nonce="{{.Nonce}}">
    ${ideStyle}
  </style>
</head>

<body>
  <!-- Panel header -->
  <section class="sn-issue-header">
    <!-- Ignore header -->
    {{if .IsIgnored}}
    <div class="sn-status-message mod-warning">
      <svg class="sn-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1.25199 12.9165C0.663992 14.0677 1.13999 15 2.31599 15H13.684C14.86 15 15.336 14.0758 14.748 12.9165L9.071 1.86645C8.476 0.71524 7.524 0.707133 6.929 1.86645L1.25899 12.9165H1.25199ZM9 13H7V11H9V13ZM9 10H7V6H9V10Z" fill="currentColor"/>
      </svg>

      <span>
        <strong>Ignored.</strong> This issue is currently ignored.
      </span>
    </div>
    {{end}}
    {{if .IsPending}}
    <div class="sn-status-message mod-warning">
      <svg class="sn-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1.25199 12.9165C0.663992 14.0677 1.13999 15 2.31599 15H13.684C14.86 15 15.336 14.0758 14.748 12.9165L9.071 1.86645C8.476 0.71524 7.524 0.707133 6.929 1.86645L1.25899 12.9165H1.25199ZM9 13H7V11H9V13ZM9 10H7V6H9V10Z" fill="currentColor"/>
      </svg>

      <span>
        This issue will be ignored once the request is approved.
      </span>
    </div>
    {{end}}
    <div class="sn-title-container">
      {{.SeverityIcon}}
      <h1 class="sn-issue-title">{{.IssueTitle}}</h1>
    </div>
    <div class="sn-issue-meta">
      <div class="severity-type">{{.IssueType}}</div>
      {{if .IgnoreLineAction}}
      <span class="delimiter"></span>
      <div>Position line: <a class="styled-link" id="position-line">{{.IgnoreLineAction}}</a></div>
      {{end}}
      {{if ge .PriorityScore 0}}
      <span class="delimiter"></span>
      <div>Priority score: {{.PriorityScore}}</div>
      {{end}}
      {{if gt (len .CWEs) 0}}
      <span class="delimiter"></span>
      {{range $index, $cwe := .CWEs}}
      <a class="cwe styled-link"  rel="noopener noreferrer"
        href="https://cwe.mitre.org/data/definitions/{{trimCWEPrefix $cwe}}.html">{{$cwe}}</a>
      {{if ne $index (idxMinusOne (len $.CWEs))}}<span class="delimiter"></span>{{end}}
      {{end}}
      {{end}}
      {{if .IsIgnored}}<div class="sn-ignore-badge">IGNORED</div>{{end}}
    </div>
    {{if .LessonUrl}}
    <div class="sn-learn">
      <div class="lesson-icon">{{.LessonIcon}}</div>
      <a class="lesson-link styled-link is-external"  rel="noopener noreferrer" href="{{.LessonUrl}}">
        Learn about this issue type
        {{.ExternalIcon}}
      </a>
    </div>
    {{end}}
  </section>

  <main class="code-issue-container">
    <!-- Tabs Issue Overview Container -->
    <article class="code-issue-panel">
      <div class="main-tabs-nav">
        {{if or .IsIgnored .IsPending}}
        <span data-tab="ignore-details" id="ignore-details-tab" class="tab-item is-selected ignore-details-tab">
          Ignore Details
        </span>
        {{end}}
        {{if not .IsIgnored}}
        <span data-tab="fix-analysis" id="fix-analysis-tab"
          class="tab-item {{if not .IsPending}}is-selected{{end}} sn-fix-analysis fix-analysis-tab">
          Fix Analysis
        </span>
        {{if gt (len .DataFlow) 0}}
        <span data-tab="data-flow-data-tab" id="data-flow-tab" class="tab-item sn-data-flow data-flow-tab">
          Data Flow
        </span>
        {{end}}
        {{end}}
        {{if .IssueOverview}}
        <span data-tab="vuln-overview" id="vuln-overview-tab" class="tab-item sn-vuln-overview vuln-overview-tab">
          Issue Overview
        </span>
        {{end}}
      </div>

      <!-- Dynamic Content Sections -->
      <div class="tab-container">
        {{if or .IsIgnored .IsPending}}
        <!-- Start Ignore Details section for tab id="ignore-details-tab" -->
        <div data-content="ignore-details" id="ignore-details-content" class="tab-content main-tab-content is-selected">
          <div class="ignore-details delimiter-top">
            {{range .IgnoreDetails}}
            <div class="ignore-details-row">
              <div class="ignore-details-label">{{.Label}}</div>
              <div class="ignore-details-value">{{.Value}}</div>
            </div>
            {{end}}
            <div class="ignore-next-step-text">
              Ignores are currently managed in the Snyk web app.
              To edit or remove the ignore please go to:
              <a class="styled-link" href="{{.SnykWebUrl}}"
                rel="noopener noreferrer">{{.SnykWebUrl}}</a>.
            </div>
          </div>
        </div>
        {{end}}
        <!-- End Ignored Details section -->

        <!-- Start Fix Analysis section for tab id="fix-analysis-tab" -->
        <div data-content="fix-analysis" id="fix-analysis-content"
          class="tab-content main-tab-content {{if and (not .IsIgnored) (not .IsPending)}}is-selected{{end}}">
          <section id="suggestion-info" class="delimiter-top">
            <div id="description" class="suggestion-text">{{.IssueMessage}}</div>
            <div class="suggestion-links">
              <div id="lead-url" class="clickable hidden">
                <svg width="9" height="9" viewBox="0 0 9 9" xmlns="http://www.w3.org/2000/svg" fill="none">
                  <path d="M4.99998 0L6.64648 1.6465L3.14648 5.1465L3.85348 5.8535L7.35348 2.3535L8.99998 4V0H4.99998Z"
                    fill="#888" />
                  <path
                    d="M8 8H1V1H4.5L3.5 0H1C0.4485 0 0 0.4485 0 1V8C0 8.5515 0.4485 9 1 9H8C8.5515 9 9 8.5515 9 8V5.5L8 4.5V8Z"
                    fill="#888" />
                </svg> More info
              </div>
            </div>
          </section>
          <!-- Data Flow and Fixed Code Examples -->
          <div id="no-ai-fix-wrapper">
            <!-- Fixed Code Examples -->
            <section class="example-fixes delimiter-top {{if .HasAIFix}}hidden{{end}}">
              <h2 class="example-fixes-header">Fixed Code Examples</h2>
              {{if eq (len .ExampleCommitFixes) 0}}
              <div id="info-no-examples" class="font-light">
                No example fixes are available.
              </div>
              {{else}}
              <p id="example-fixes-info-top" class="example-fixes-info-top font-light">
                This type of vulnerability was fixed in {{.RepoCount}} open source projects.
              </p>
              <div id="example-top" class="row between">
                <div id="current-example" class="repo clickable">
                  {{.GitHubIcon}}
                  <span id="example-link" class="example-repo-link">
                    <a id="example-repo-anchor" href="{{(index .ExampleCommitFixes 0).RepoLink}}"
                       rel="noopener noreferrer">
                      {{(index .ExampleCommitFixes 0).RepoName}}
                    </a>
                  </span>
                </div>
                <div class="examples-nav">
                  <span id="previous-example" class="arrow" title="Previous example">
                    {{.ArrowLeftDark}}
                    {{.ArrowLeftLight}}
                  </span>
                  <span id="example-text">
                    Example <strong id="example-counter">1</strong>/<span id="example-number2">{{.ExampleCount}}</span>
                  </span>
                  <span id="next-example" class="arrow" title="Next example">
                    {{.ArrowRightDark}}
                    {{.ArrowRightLight}}
                  </span>
                </div>
              </div>

              <div id="example" class="example">
                {{range $index, $element := .ExampleCommitFixes}}
                <div class="example-detail {{if ne $index 0}}hidden{{end}}" data-index=" {{$index}}">
                  <div>
                    {{range $element.ExampleLines}}
                    <div class="example-line {{.LineChange}}">
                      <code>{{.Line}}</code>
                    </div>
                    {{end}}
                  </div>
                </div>
                {{end}}
              </div>
              {{end}}
            </section>
          </div>
          <!-- AI Fix -->
          <div id="ai-fix-wrapper" class="{{if not .HasAIFix}}hidden{{end}}">
            <!-- AI fix buttons -->
            <section id="fix-wrapper" class="ai-fix delimiter-top {{if or (eq .AiFixDiffStatus "NOT_STARTED") (eq .AiFixDiffStatus "IN_PROGRESS")}} show {{else}} hidden {{end}} ">
              <h2 class="ai-fix-header">
                DeepCode AI Fixes
              </h2>
              <p class='{{if ne .AiFixDiffStatus "NOT_STARTED"}}hidden{{end}}'>⚡ Fix this issue by generating a solution using Snyk DeepCode AI</p>

              <div class="sn-fix-wrapper">
                <button id="generate-ai-fix" folder-path="{{.FolderPath}}" file-path="{{.FilePath}}"
                  class="generate-ai-fix {{if eq .AiFixDiffStatus "NOT_STARTED"}} show {{else}} hidden {{end}}">✨ Generate AI fix</button>
                <div id="fix-loading-indicator" class="sn-loading {{if eq .AiFixDiffStatus "IN_PROGRESS"}} show {{else}} hidden {{end}}">
                  <div class="sn-loading-icon">
                    {{.ScanAnimation}}
                  </div>
                  <div class="sn-loading-wrapper">
                    <div class="sn-loading-message sn-msg-1">
                      <span class="sn-loading-title">1<span class="font-light">/5</span> Code Reduction...</span>
                      <p class="sn-loading-description">Reduces the given files to a smaller and relevant code snippet.
                      </p>
                    </div>
                    <div class="sn-loading-message sn-msg-2">
                      <span class="sn-loading-title">2<span class="font-light">/5</span> Parsing...</span>
                      <p class="sn-loading-description">Analyzing symbols and generating the graph representation.</p>
                    </div>
                    <div class="sn-loading-message sn-msg-3">
                      <span class="sn-loading-title">3<span class="font-light">/5</span> Static Analysis...</span>
                      <p class="sn-loading-description">Examining the vulnerability code without having to execute the
                        program.</p>
                    </div>
                    <div class="sn-loading-message sn-msg-4">
                      <span class="sn-loading-title">4<span class="font-light">/5</span> Inferencing...</span>
                      <p class="sn-loading-description">Feeding the reduced code to our neural network to obtain the
                        prediction.</p>
                    </div>
                    <div class="sn-loading-message sn-msg-5">
                      <span class="sn-loading-title">5<span class="font-light">/5</span> Explaining...</span>
                      <p class="sn-loading-description">Generating AI explanations for the fixes.</p>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            <!-- AI fixes -->
            <section id="fixes-section" class="sn-ai-fixes delimiter-top {{if eq .AiFixDiffStatus "SUCCESS"}} show {{else}} hidden {{end}}">
              <div id="info-no-diffs" class="font-light {{if eq .AiFixResult "{}"}} show {{else}} hidden {{end}}">
                <h3 class="ai-fix-header">No AI Fix Available:</h3>
                We couldn’t generate fixes that meet our high-quality standards.
                <br>
                To ensure your code remains secure and error-free, no automatic fix suggestion will be recommended for this issue.
                <br>
                You can review suggested areas to improve or retry once updates have been made.
                <br>
                Read more in our
                <a class="styled-link" href="https://docs.snyk.io/scan-with-snyk/snyk-code/manage-code-vulnerabilities/fix-code-vulnerabilities-automatically#limitations">
                [documentation]
                </a>
              </div>

              <div class="diffs-section {{if eq .AiFixResult "{}"}} hidden {{else}} show {{end}}">
                <div id="diff-top" class="row between">
                  <div id="info-top" class="font-light">⚡️ Here are <span id="diff-number"></span> AI-generated solutions
                  </div>
                  <div class="diffs-nav">
                          <span id="previous-diff" class="arrow" title="Previous diff">
                            {{.ArrowLeftDark}}
                            {{.ArrowLeftLight}}
                          </span>
                    <span id="diff-text">
                            AI solution <strong id="diff-counter">1</strong>/<span id="diff-number2"></span>
                          </span>
                    <span id="next-diff" class="arrow" title="Next diff">
                            {{.ArrowRightDark}}
                            {{.ArrowRightLight}}
                          </span>
                  </div>
                </div>
                <div id="diff"></div>
                <div class="explain-wrapper">
                  <h2 id="ai-explain-header" class="hidden">Explanation: </h2>
                  <div id="fix-explain-text" class="suggestion-text">
                  </div>
                  <button id="apply-fix" class="button sn-apply-fix">Apply fix</button>
                </div>
              </div>
            </section>

            <!-- AI fix errors -->
            <section id="fixes-error-section" class="sn-ai-fix-error delimiter-top {{if eq .AiFixDiffStatus "ERROR"}} show {{else}} hidden {{end}}">
              <div id="info-no-diffs" class="font-light">
                ⚠️ Failed to generate the fix. Please try again.
              </div>
              <div class="sn-fix-wrapper">
                <button id="retry-generate-fix" class="button generate-ai-fix">✨ Retry AI fix</button>
              </div>
            </section>
          </div>
        </div>
        <!-- End Fix Analysis section -->

        <!-- Start Vulnerability Overview section for tab id="vuln-overview-tab" -->
        <div id="vuln-overview-content" class="tab-content main-tab-content" data-content="vuln-overview">
          <!-- Content for Vulnerability Overview -->
          <section class="issue-overview delimiter-top">
            <div class="overview-text">
              {{.IssueOverview}}
            </div>
          </section>
        </div>
        <!-- End Vulnerability Overview section -->

        <!-- Data Flow -->
        <div id="data-flow-content" class="tab-content main-tab-content" data-content="data-flow-data-tab">
          <section class="data-flow-section delimiter-top">
            <h2 class="data-flow-header">
              Data Flow - {{len .DataFlow}} {{if gt (len .DataFlow) 1}}steps{{else}}step{{end}}
            </h2>
            <div class="data-flow-body">
              {{range $fileName := .DataFlowKeys}}
              {{ $stepCount := len (index $.DataFlowTable $fileName) }}
              <div class="data-flow-file">
                <span class="data-flow-file-name">{{$.FileIcon}} {{$fileName}}</span>
                <span class="data-flow-file-steps">{{$stepCount}} {{if eq $stepCount 1}}step{{else}}steps{{end}}</span>
              </div>
              <table class="data-flow-table">
                <tbody>
                {{range index $.DataFlowTable $fileName}}
                <tr class="data-flow-row">

                  <td class="data-flow-clickable-row" file-path="{{.FilePath}}" start-line="{{.StartLine}}"
                      end-line="{{.EndLine}}" start-character="{{.StartCharacter}}" end-character="{{.EndCharacter}}">
                    {{.StartLineValue}}
                  </td>
                  <!-- <td class="delimiter data-flow-delimiter">|</td> -->
                  <td class="data-flow-text">
                    <code>{{.Content}}</code>
                  </td>
                  <td class="data-flow-number">
                    <div class="data-flow-circle">{{.Number}}</div>
                    <div class="data-flow-line"></div>
                  </td>
                </tr>
                {{end}}
                </tbody>

              </table>
              {{end}}
            </div>
          </section>
        </div>
      </div>
    </article>
  </main>

  {{if and (.IAWEnabled) (not .IsIgnored) (not .IsPending)}}
  <div id="ignore-form-container" class="sn-ignore-issue-container hidden">
    <h2 class="sn-ignore-title">Ignore this issue</h2>
    <p class="sn-ignore-description">This ignore will reflect once it has been approved.</p>

    <div class="sn-field">
      <div class="sn-label">Ignore type</div>
      <select class="sn-select" id="ignore-form-type">
        <option value="not-vulnerable">Not vulnerable</option>
        <option value="wont-fix">Won't fix</option>
        <option value="temporary-ignore">Temporary ignore</option>
      </select>
    </div>

    <div class="sn-field">
      <div class="sn-label">Expiration</div>
      <select class="sn-select" id="ignore-form-expiration-type">
        <option value="do-not-expire">Do not expire</option>
        <option value="custom-expiration-date">Custom expiration date</option>
      </select>
      <input class="sn-input hidden" id="ignore-form-expiration-date" type="date" value="{{.ExpirationDate}}">
    </div>

    <div class="sn-field">
      <div class="sn-label">Ignore reason</div>
      <textarea class="sn-textarea" id="ignore-form-ignore-reason" rows="4" placeholder="Please provide a reason for ignoring this issue"></textarea>
    </div>

    <div class="sn-field mod-right-aligned">
      <button id="ignore-form-submit" class="sn-button">Submit ignore</button>
      <button id="ignore-form-cancel" class="sn-button mod-ghost">Cancel</button>
    </div>
  </div>
  {{end}}

  <div id="suggestionDiv" class="hidden">
    {{.AiFixResult}}
  </div>
  <!-- Ignore In Line Actions -->
  {{if and (not .IsIgnored) (not .IsPending)}}
  <footer class="ignore-action-container">
    <div id="ignore-actions">
      {{if .IAWEnabled}}
      <div id="ignore-cci-actions" class="actions row">
        <button id="ignore-create" class="ignore-button secondary">Create ignore</button>
      </div>
      {{else}}
      <div id="ignore-legacy-actions" class="actions row hidden">
        <button id="ignore-line-issue" class="ignore-button secondary">Ignore on line <span
            id="action-ignore-line">{{.IgnoreLineAction}}</span></button>
        <button id="ignore-file-issue" class="ignore-button secondary">Ignore in this file</button>
      </div>
      {{end}}
    </div>
  </footer>
  {{end}}

  <!-- Scripts -->
  <script nonce="{{.Nonce}}">
    /**
     * Represents a single line change in a commit.
     * @typedef {Object} ExampleLine
     * @property {number} LineNumber  - The line number of the change.
     * @property {string} Line        - The content of the line.
     * @property {string} LineChange  - The type of change ('added' or 'removed').
     */

    /**
     * Represents a commit fix with detailed change lines.
     * @typedef {Object} ExampleCommitFix
     * @property {string} CommitURL           - URL to the full commit diff.
     * @property {string} RepoName            - Name of the repository.
     * @property {string} RepoLink            - Direct link to the repository.
     * @property {ExampleLine[]} ExampleLines - An array of line changes.
     */

// Constants for class and ID names
    var MAIN_TAB_NAV_SELECTOR = '.main-tabs-nav';
    var MAIN_TAB_ITEM_SELECTOR = '.main-tabs-nav .tab-item';
    var MAIN_TAB_CONTENT_SELECTOR = '.tab-container > .main-tab-content';
    var EXAMPLE_COUNTER = 'example-counter';
    var EXAMPLE_PREVIOUS = 'previous-example';
    var EXAMPLE_NEXT = 'next-example';
    var EXAMPLE_REPO_ANCHOR = 'example-repo-anchor';
    var ALL_EXAMPLES_DETAIL = '.example-detail';

    // Utility functions
    function toggleIsSelectedClass(elements, shouldToggle) {
      if (!elements) {
        return;
      }
      for (var i = 0; i < elements.length; i++) {
        var el = elements[i];
        if (shouldToggle(el)) {
          if (el.className.indexOf('is-selected') === -1) {
            el.className += ' is-selected';
          }
        } else {
          el.className = el.className.replace(/(?:^|\s)is-selected(?!\S)/g, '');
        }
      }
    }
    function polyfillClosest() {
      if (!Element.prototype.closest) {
        Element.prototype.closest = function (s) {
          var matches = (this.document || this.ownerDocument).querySelectorAll(s),
            i, el = this;
          do {
            i = matches.length;
            while (--i >= 0 && matches.item(i) !== el) {};
          } while ((i < 0) && (el = el.parentElement));
          return el;
        };
      }
    }
    polyfillClosest();
    document.addEventListener('DOMContentLoaded', function () {
      var exampleCounter = document.getElementById(EXAMPLE_COUNTER);
      var examplePrevious = document.getElementById(EXAMPLE_PREVIOUS);
      var exampleNext = document.getElementById(EXAMPLE_NEXT);
      var exampleRepoAnchor = document.getElementById(EXAMPLE_REPO_ANCHOR);
      var allExamplesDetail = document.querySelectorAll(ALL_EXAMPLES_DETAIL);
      var mainTabLinks = document.querySelectorAll(MAIN_TAB_ITEM_SELECTOR);
      var mainTabContents = document.querySelectorAll(MAIN_TAB_CONTENT_SELECTOR);
      var mainTabNav = document.querySelector(MAIN_TAB_NAV_SELECTOR);
      var exampleCount = 0;

      /** @type {ExampleCommitFix[]} */
      var exampleCommitFixes = JSON.parse("{{.CommitFixes}}" || '[]');
      function showCurrentExample() {
        if (!allExamplesDetail) {
          return;
        }
        for (var i = 0; i < allExamplesDetail.length; i++) {
          var example = allExamplesDetail[i];
          if (i === exampleCount) {
            example.className = example.className.replace(/(?:^|\s)hidden(?!\S)/g, '');
          } else {
            if (example.className.indexOf('hidden') === -1) {
              example.className += ' hidden';
            }
          }
        }
        if (exampleCounter) {
          exampleCounter.textContent = exampleCount + 1;
        }
        if (exampleRepoAnchor && exampleCommitFixes) {
          exampleRepoAnchor.textContent = exampleCommitFixes[exampleCount].RepoName;
          exampleRepoAnchor.href = exampleCommitFixes[exampleCount].RepoLink;
        }
      }
      function previousExample() {
        if (exampleCount > 0) {
          exampleCount--;
          showCurrentExample();
        }
      }
      function nextExample() {
        if (exampleCount < exampleCommitFixes.length - 1) {
          exampleCount++;
          showCurrentExample();
        }
      }
      if (mainTabNav) {
        mainTabNav.onclick = function (event) {
          var clickedTab = event.target.closest('.tab-item');
          if (!clickedTab) return;
          var selectedTab = clickedTab.getAttribute('data-tab');

          // Toggle selected tab and content
          toggleIsSelectedClass(mainTabLinks, function (tab) {
            return tab === clickedTab;
          });
          toggleIsSelectedClass(mainTabContents, function (content) {
            return content.getAttribute('data-content') === selectedTab;
          });
        };
      }
      if (examplePrevious) {
        examplePrevious.onclick = previousExample;
      }
      if (exampleNext) {
        exampleNext.onclick = nextExample;
      }
      showCurrentExample();
      {{if ne .AiFixDiffStatus "NOT_STARTED"}}
      window.scrollTo(0, document.body.scrollHeight);
      {{end}}

      {{if eq .AiFixDiffStatus "SUCCESS"}}
      showCurrentDiff();
      {{end}}
    });
  </script>
  {{if and (.IAWEnabled) (not .IsIgnored) (not .IsPending)}}
  <script nonce="{{.Nonce}}">
    // Polyfill for datepicker from https://brianblakely.github.io/nodep-date-input-polyfill/nodep-date-input-polyfill.dist.js taken 28th April 2025
    // Creates a style with the hash: sha256-xTz+BhbUie/RZ+GiIGx9ilUKue8VdBpNwgjwIbRfO/E=
    (function(a,b){'object'==typeof exports&&'undefined'!=typeof module?b():'function'==typeof define&&define.amd?define(b):b()})(this,function(){'use strict';(function(a){if(a&&'undefined'!=typeof window){var b=document.createElement('style');return b.setAttribute('type','text/css'),b.innerHTML=a,document.head.appendChild(b),a}})('date-input-polyfill {\n  background: #fff;\n  color: #000;\n  text-shadow: none;\n  border: 0;\n  padding: 0;\n  height: auto;\n  width: auto;\n  line-height: normal;\n  border-radius: 0;\n  font-family: sans-serif;\n  font-size: 14px;\n  position: absolute !important;\n  text-align: center;\n  box-shadow: 0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 12px 17px 2px rgba(0, 0, 0, 0.14), 0 5px 22px 4px rgba(0, 0, 0, 0.12);\n  cursor: default;\n  z-index: 1; }\n  date-input-polyfill[data-open="false"] {\n    display: none; }\n  date-input-polyfill[data-open="true"] {\n    display: block; }\n  date-input-polyfill select, date-input-polyfill table, date-input-polyfill th, date-input-polyfill td {\n    background: #fff;\n    color: #000;\n    text-shadow: none;\n    border: 0;\n    padding: 0;\n    height: auto;\n    width: auto;\n    line-height: normal;\n    border-radius: 0;\n    font-family: sans-serif;\n    font-size: 14px;\n    box-shadow: none; }\n  date-input-polyfill select, date-input-polyfill button {\n    border: 0;\n    border-bottom: 1px solid #E0E0E0;\n    height: 24px;\n    vertical-align: top; }\n  date-input-polyfill select {\n    width: 50%; }\n    date-input-polyfill select:first-of-type {\n      border-right: 1px solid #E0E0E0;\n      width: 30%; }\n  date-input-polyfill button {\n    padding: 0;\n    width: 20%;\n    background: #E0E0E0; }\n  date-input-polyfill table {\n    border-collapse: collapse; }\n  date-input-polyfill th, date-input-polyfill td {\n    width: 32px;\n    padding: 4px;\n    text-align: center; }\n  date-input-polyfill td[data-day] {\n    cursor: pointer; }\n    date-input-polyfill td[data-day]:hover {\n      background: #E0E0E0; }\n  date-input-polyfill [data-selected] {\n    font-weight: bold;\n    background: #D8EAF6; }\n\ninput[data-has-picker]::-ms-clear {\n  display: none; }\n');var a=function(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')},b=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),c=function(){function c(){var b=this;if(a(this,c),c.instance)return c.instance;this.date=new Date,this.input=null,this.isOpen=!1,this.container=document.createElement('date-input-polyfill'),this.year=document.createElement('select'),c.createRangeSelect(this.year,this.date.getFullYear()-80,this.date.getFullYear()+20),this.year.className='yearSelect',this.year.addEventListener('change',function(){b.date.setYear(b.year.value),b.refreshDaysMatrix()}),this.container.appendChild(this.year),this.month=document.createElement('select'),this.month.className='monthSelect',this.month.addEventListener('change',function(){b.date.setMonth(b.month.value),b.refreshDaysMatrix()}),this.container.appendChild(this.month),this.today=document.createElement('button'),this.today.textContent='Today',this.today.addEventListener('click',function(){b.date=new Date,b.setInput()}),this.container.appendChild(this.today);var d=document.createElement('table');this.daysHead=document.createElement('thead'),this.days=document.createElement('tbody'),this.days.addEventListener('click',function(a){var c=a.target;if(!c.hasAttribute('data-day'))return!1;var d=b.days.querySelector('[data-selected]');d&&d.removeAttribute('data-selected'),c.setAttribute('data-selected',''),b.date.setDate(parseInt(c.textContent)),b.setInput()}),d.appendChild(this.daysHead),d.appendChild(this.days),this.container.appendChild(d),this.hide(),document.body.appendChild(this.container),document.addEventListener('click',function(a){for(var c=a.target,d=c===b.container;!d&&(c=c.parentNode);)d=c===b.container;'date'===a.target.getAttribute('type')||d||b.hide()})}return b(c,[{key:'hide',value:function(){this.container.setAttribute('data-open',this.isOpen=!1)}},{key:'show',value:function(){this.container.setAttribute('data-open',this.isOpen=!0)}},{key:'goto',value:function(a){var b=a.getBoundingClientRect();this.container.style.top=b.top+b.height+(document.documentElement.scrollTop||document.body.scrollTop)+'px',this.container.style.left=b.left+(document.documentElement.scrollLeft||document.body.scrollLeft)+'px',this.show()}},{key:'attachTo',value:function(a){return a===this.input&&this.isOpen?!1:void(this.input=a,this.sync(),this.goto(this.input.element))}},{key:'sync',value:function(){this.date=this.input.element.valueAsDate?c.absoluteDate(this.input.element.valueAsDate):new Date,this.year.value=this.date.getFullYear(),this.month.value=this.date.getMonth(),this.refreshDaysMatrix()}},{key:'setInput',value:function(){var a=this;this.input.element.value=this.date.getFullYear()+'-'+('0'+(this.date.getMonth()+1)).slice(-2)+'-'+('0'+this.date.getDate()).slice(-2),this.input.element.focus(),setTimeout(function(){a.hide()},100),this.pingInput()}},{key:'refreshLocale',value:function(){if(this.locale===this.input.locale)return!1;this.locale=this.input.locale;for(var a=['<tr>'],b=0,d=this.input.localeText.days.length;b<d;++b)a.push('<th scope="col">'+this.input.localeText.days[b]+'</th>');this.daysHead.innerHTML=a.join(''),c.createRangeSelect(this.month,0,11,this.input.localeText.months,this.date.getMonth()),this.today.textContent=this.input.localeText.today}},{key:'refreshDaysMatrix',value:function(){this.refreshLocale();for(var a=this.date.getFullYear(),b=this.date.getMonth(),d=new Date(a,b,1).getDay(),e=new Date(this.date.getFullYear(),b+1,0).getDate(),f=c.absoluteDate(this.input.element.valueAsDate)||!1,g=f&&a===f.getFullYear()&&b===f.getMonth(),h=[],j=0;j<e+d;++j){if(0==j%7&&h.push('\n          '+(0===j?'':'</tr>')+'\n          <tr>\n        '),j+1<=d){h.push('<td></td>');continue}var i=j+1-d,k=g&&f.getDate()===i;h.push('<td data-day '+(k?'data-selected':'')+'>\n          '+i+'\n        </td>')}this.days.innerHTML=h.join('')}},{key:'pingInput',value:function(){var a,b;try{a=new Event('input'),b=new Event('change')}catch(c){a=document.createEvent('KeyboardEvent'),a.initEvent('input',!0,!1),b=document.createEvent('KeyboardEvent'),b.initEvent('change',!0,!1)}this.input.element.dispatchEvent(a),this.input.element.dispatchEvent(b)}}],[{key:'createRangeSelect',value:function(a,b,c,d,e){a.innerHTML='';for(var f,g=b;g<=c;++g){f=document.createElement('option'),a.appendChild(f);var h=d?d[g-b]:g;f.text=h,f.value=g,g===e&&(f.selected='selected')}return a}},{key:'absoluteDate',value:function(a){return a&&new Date(a.getTime()+1e3*(60*a.getTimezoneOffset()))}}]),c}();c.instance=null;var d={"en_en-US":{days:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],today:'Today',format:'M/D/Y'},"en-GB":{days:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],today:'Today',format:'D/M/Y'},"zh_zh-CN":{days:['\u661F\u671F\u5929','\u661F\u671F\u4E00','\u661F\u671F\u4E8C','\u661F\u671F\u4E09','\u661F\u671F\u56DB','\u661F\u671F\u4E94','\u661F\u671F\u516D'],months:['\u4E00\u6708','\u4E8C\u6708','\u4E09\u6708','\u56DB\u6708','\u4E94\u6708','\u516D\u6708','\u4E03\u6708','\u516B\u6708','\u4E5D\u6708','\u5341\u6708','\u5341\u4E00\u6708','\u5341\u4E8C\u6708'],today:'\u4ECA\u5929',format:'Y/M/D'},"zh-Hans_zh-Hans-CN":{days:['\u5468\u65E5','\u5468\u4E00','\u5468\u4E8C','\u5468\u4E09','\u5468\u56DB','\u5468\u4E94','\u5468\u516D'],months:['\u4E00\u6708','\u4E8C\u6708','\u4E09\u6708','\u56DB\u6708','\u4E94\u6708','\u516D\u6708','\u4E03\u6708','\u516B\u6708','\u4E5D\u6708','\u5341\u6708','\u5341\u4E00\u6708','\u5341\u4E8C\u6708'],today:'\u4ECA\u5929',format:'Y/M/D'},"zh-Hant_zh-Hant-TW":{days:['\u9031\u65E5','\u9031\u4E00','\u9031\u4E8C','\u9031\u4E09','\u9031\u56DB','\u9031\u4E94','\u9031\u516D'],months:['\u4E00\u6708','\u4E8C\u6708','\u4E09\u6708','\u56DB\u6708','\u4E94\u6708','\u516D\u6708','\u4E03\u6708','\u516B\u6708','\u4E5D\u6708','\u5341\u6708','\u5341\u4E00\u6708','\u5341\u4E8C\u6708'],today:'\u4ECA\u5929',format:'Y/M/D'},"de_de-DE":{days:['So','Mo','Di','Mi','Do','Fr','Sa'],months:['Januar','Februar','M\xE4rz','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'],today:'Heute',format:'D.M.Y'},"da_da-DA":{days:['S\xF8n','Man','Tirs','Ons','Tors','Fre','L\xF8r'],months:['Januar','Februar','Marts','April','Maj','Juni','Juli','August','September','Oktober','November','December'],today:'I dag',format:'D/M/Y'},es:{days:['Dom','Lun','Mar','Mi\xE9','Jue','Vie','S\xE1b'],months:['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'],today:'Hoy',format:'D/M/Y'},hi:{days:['\u0930\u0935\u093F','\u0938\u094B\u092E','\u092E\u0902\u0917\u0932','\u092C\u0941\u0927','\u0917\u0941\u0930\u0941','\u0936\u0941\u0915\u094D\u0930','\u0936\u0928\u093F'],months:['\u091C\u0928\u0935\u0930\u0940','\u092B\u0930\u0935\u0930\u0940','\u092E\u093E\u0930\u094D\u091A','\u0905\u092A\u094D\u0930\u0947\u0932','\u092E\u0948','\u091C\u0942\u0928','\u091C\u0942\u0932\u093E\u0908','\u0905\u0917\u0938\u094D\u0924','\u0938\u093F\u0924\u092E\u094D\u092C\u0930','\u0906\u0915\u094D\u091F\u094B\u092C\u0930','\u0928\u0935\u092E\u094D\u092C\u0930','\u0926\u093F\u0938\u092E\u094D\u092C\u0930'],today:'\u0906\u091C',format:'D/M/Y'},pt:{days:['Dom','Seg','Ter','Qua','Qui','Sex','S\xE1b'],months:['Janeiro','Fevereiro','Mar\xE7o','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'],today:'Hoje',format:'D/M/Y'},ja:{days:['\u65E5','\u6708','\u706B','\u6C34','\u6728','\u91D1','\u571F'],months:['1\u6708','2\u6708','3\u6708','4\u6708','5\u6708','6\u6708','7\u6708','8\u6708','9\u6708','10\u6708','11\u6708','12\u6708'],today:'\u4ECA\u65E5',format:'Y/M/D'},"nl_nl-NL_nl-BE":{days:['Zondag','Maandag','Dinsdag','Woensdag','Donderdag','Vrijdag','Zaterdag'],months:['Januari','Februari','Maart','April','Mei','Juni','Juli','Augustus','September','Oktober','November','December'],today:'Vandaag',format:'D/M/Y'},"tr_tr-TR":{days:['Pzr','Pzt','Sal','\xC7r\u015F','Pr\u015F','Cum','Cmt'],months:['Ocak','\u015Eubat','Mart','Nisan','May\u0131s','Haziran','Temmuz','A\u011Fustos','Eyl\xFCl','Ekim','Kas\u0131m','Aral\u0131k'],today:'Bug\xFCn',format:'D/M/Y'},"fr_fr-FR":{days:['Dim','Lun','Mar','Mer','Jeu','Ven','Sam'],months:['Janvier','F\xE9vrier','Mars','Avril','Mai','Juin','Juillet','Ao\xFBt','Septembre','Octobre','Novembre','D\xE9cembre'],today:'Auj.',format:'D/M/Y'},"uk_uk-UA":{days:['\u041D\u0434','\u041F\u043D','\u0412\u0442','\u0421\u0440','\u0427\u0442','\u041F\u0442','\u0421\u0431'],months:['\u0421\u0456\u0447\u0435\u043D\u044C','\u041B\u044E\u0442\u0438\u0439','\u0411\u0435\u0440\u0435\u0437\u0435\u043D\u044C','\u041A\u0432\u0456\u0442\u0435\u043D\u044C','\u0422\u0440\u0430\u0432\u0435\u043D\u044C','\u0427\u0435\u0440\u0432\u0435\u043D\u044C','\u041B\u0438\u043F\u0435\u043D\u044C','\u0421\u0435\u0440\u043F\u0435\u043D\u044C','\u0412\u0435\u0440\u0435\u0441\u0435\u043D\u044C','\u0416\u043E\u0432\u0442\u0435\u043D\u044C','\u041B\u0438\u0441\u0442\u043E\u043F\u0430\u0434','\u0413\u0440\u0443\u0434\u0435\u043D\u044C'],today:'\u0421\u044C\u043E\u0433\u043E\u0434\u043D\u0456',format:'D.M.Y'},it:{days:['Dom','Lun','Mar','Mer','Gio','Ven','Sab'],months:['Gennaio','Febbraio','Marzo','Aprile','Maggio','Giugno','Luglio','Agosto','Settembre','ottobre','Novembre','Dicembre'],today:'Oggi',format:'D/M/Y'},pl:{days:['Nie','Pon','Wto','\u015Aro','Czw','Pt','Sob'],months:['Stycze\u0144','Luty','Marzec','Kwiecie\u0144','Maj','Czerwiec','Lipiec','Sierpie\u0144','Wrzesie\u0144','Pa\u017Adziernik','Listopad','Grudzie\u0144'],today:'Dzisiaj',format:'D.M.Y'}},e=function(){function e(b){var d=this;a(this,e),this.element=b,this.element.setAttribute('data-has-picker','');for(var f=this.element,g='';f.parentNode&&(g=f.getAttribute('lang'),!g);)f=f.parentNode;this.locale=g||'en',this.localeText=this.getLocaleText(),Object.defineProperties(this.element,{value:{get:function(){return d.element.polyfillValue},set:function(a){if(!/^\d{4}-\d{2}-\d{2}$/.test(a))return d.element.polyfillValue='',d.element.setAttribute('value',''),!1;d.element.polyfillValue=a;var b=a.split('-');d.element.setAttribute('value',d.localeText.format.replace('Y',b[0]).replace('M',b[1]).replace('D',b[2]))}},valueAsDate:{get:function(){return d.element.polyfillValue?new Date(d.element.polyfillValue):null},set:function(a){d.element.value=a.toISOString().slice(0,10)}},valueAsNumber:{get:function(){return d.element.value?d.element.valueAsDate.getTime():NaN},set:function(a){d.element.valueAsDate=new Date(a)}}}),this.element.value=this.element.getAttribute('value');var h=function(){c.instance.attachTo(d)};this.element.addEventListener('focus',h),this.element.addEventListener('mousedown',h),this.element.addEventListener('mouseup',h),this.element.addEventListener('keydown',function(a){var b=new Date;switch(a.keyCode){case 27:c.instance.hide();break;case 38:d.element.valueAsDate&&(b.setDate(d.element.valueAsDate.getDate()+1),d.element.valueAsDate=b,c.instance.pingInput());break;case 40:d.element.valueAsDate&&(b.setDate(d.element.valueAsDate.getDate()-1),d.element.valueAsDate=b,c.instance.pingInput());break;default:}c.instance.sync()})}return b(e,[{key:'getLocaleText',value:function(){var a=this.locale.toLowerCase();for(var b in d){var c=b.split('_').map(function(a){return a.toLowerCase()});if(!!~c.indexOf(a))return d[b]}for(var e in d){var f=e.split('_').map(function(a){return a.toLowerCase()});if(!!~f.indexOf(a.substr(0,2)))return d[e]}return this.locale='en',this.getLocaleText()}}],[{key:'supportsDateInput',value:function(){var a=document.createElement('input');a.setAttribute('type','date');var b='not-a-date';return a.setAttribute('value',b),document.currentScript&&!document.currentScript.hasAttribute('data-nodep-date-input-polyfill-debug')&&a.value!==b}},{key:'addPickerToDateInputs',value:function(){var a=document.querySelectorAll('input[type="date"]:not([data-has-picker]):not([readonly])'),b=a.length;if(!b)return!1;for(var c=0;c<b;++c)new e(a[c])}}]),e}();if(!e.supportsDateInput()){var f=function(){c.instance=new c,e.addPickerToDateInputs(),document.querySelector('body').addEventListener('mousedown',function(){e.addPickerToDateInputs()})};if('complete'===document.readyState)f();else{var g=!1;document.addEventListener('DOMContentLoaded',function(){g=!0,f()}),window.addEventListener('load',function(){g||f()})}}});
  </script>
  {{end}}
  <!-- Embedded script from LS  -->
  <script nonce="{{.Nonce}}">
    var suggestion = JSON.parse("{{.AiFixResult}}" || "[]")
    var issueId = "{{.IssueId}}"
    {{.Scripts}}
    // some IDEs take longer to inject their handler functions
    // TODO: Should we add an event listener when the IDE functions are loaded?
    {{if .AutoTriggerAiFix }}
    setTimeout(function () {
      generateAIFix();
    }, 500);
    {{end}}
  </script>
  <!-- Custom IDE specific scripts  -->
  <script nonce="{{.Nonce}}">
    ${ideScript}
  </script>
</body>

</html>
